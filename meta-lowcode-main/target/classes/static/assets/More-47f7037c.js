import{R as e,r as t,v as l,l as i,o,a,c as s,w as n,z as r,g as p,e as d,f as m,F as c,E as u,a0 as f,i as y,bh as j,bf as v}from"./@vue-1ad4818c.js";import g from"./SetColumn-15f4404b.js";import h from"./DataExport-cabbbed3.js";import C from"./Allocation-359987ff.js";import b from"./ReportForms-7661dfe6.js";import S from"./DefaultFilterDialog-f7a53bd1.js";import{_ as k,f as F,k as E}from"./index-ea085229.js";import{u as _}from"./vue-router-414ebc36.js";import"./vue-draggable-next-a413f884.js";import"./pinia-3f60a8e1.js";import"./element-plus-bab58d46.js";import"./lodash-es-b8e8104a.js";import"./@vueuse-477b4dbb.js";import"./@element-plus-2a6d398c.js";import"./@babel-6bd44fd1.js";import"./@popperjs-b78c3215.js";import"./@ctrl-4982d949.js";import"./dayjs-7fb79ad3.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./escape-html-3148dbc9.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-0ef99041.js";import"./vue3-manner-report-313033e6.js";import"./axios-85bcd05e.js";import"./crypto-js-43a3a23e.js";import"./cron-parser-1391a961.js";import"./luxon-b01799b6.js";import"./nprogress-c04e6182.js";import"./sortablejs-2f5483e3.js";import"./qrcodejs2-fix-bab07f30.js";import"./moment-bafe441d.js";import"./pinyin-pro-c81f5d39.js";import"./vue-i18n-0843b5c5.js";import"./@intlify-2528d766.js";import"./source-map-b06bd4b9.js";import"./vue-c723f8b1.js";import"./pinia-plugin-persistedstate-d2bd58cf.js";import"./resize-observer-polyfill-ad543aa3.js";import"./vue-smart-widget-8b3f5b0a.js";import"./echarts-b5d24e9a.js";import"./zrender-a15b073b.js";import"./tslib-a4e99503.js";import"./echarts-liquidfill-f5c863f1.js";import"./@antv-43d380be.js";import"./ant-design-vue-2db0c9af.js";import"./@ant-design-60f2ef8e.js";import"./vue-types-6bcea8eb.js";import"./dom-align-78cb5391.js";import"./vue-resize-observer-90aea344.js";const w=e=>(j("data-v-b450bdee"),e=e(),v(),e),I={class:"table-setting-item-box"},D=w((()=>p("div",{class:"pl-5 item div-disabled"},"操作",-1))),x={class:"icon-t1"},L={class:"icon-t1"},N={class:"icon-t1"},R={class:"icon-t1"},A={class:"icon-t1"},z={class:"icon-t1"},O=w((()=>p("div",{class:"pl-5 mt-15 item div-disabled"},"导入导出",-1))),M={class:"icon-t1"},T={class:"icon-t1"},q=w((()=>p("div",{class:"pl-5 mt-15 div-disabled"},"列显示",-1))),P={class:"action-icon"},V={key:0,class:"action-icon"},$={key:1,class:"pl-5 mt-15 div-disabled"},B=k({__name:"More",props:{defaultColumnShow:{type:String,default:""},idFieldName:{type:String,default:""},nameFieldName:{type:String,default:""},layoutConfig:{type:Object,default:()=>{}},tableColumn:{type:Array,default:()=>[]},multipleSelection:{type:Array,default:()=>[]},dataExportData:{type:Object,default:()=>{}},type:{type:String,default:"list"},entityCode:{type:Number,default:0},detailId:{type:String,default:""},defaultFilterSetting:{type:Object,default:()=>{}}},emits:["changeColumnShow","editColumnConfirm","defaultFilterChange"],setup(j,{expose:v,emit:k}){const w=j,{queryEntityNameById:B}=F(),U=_();e("$API");const G=e("$TOOL"),H=e("$ElMessage");let J=t("");const K={del:{type:4,label:"删除"},allocation:{type:5,label:"分配"},share:{type:6,label:"共享"},unShare:{type:6,label:"取消共享"}},Q=async e=>{if(w.multipleSelection.length>0)if(1==w.multipleSelection.length){let t={id:w.detailId||w.multipleSelection[0][w.idFieldName],rightType:K[e].type},l=await E(t.id,t.rightType);200==l.data.code&&l.data.data?W(e):H.error("当前用户没有"+K[e].label+"权限")}else W(e)},W=e=>{J.value.openDialog({type:e,pageType:w.type,list:w.multipleSelection})},X=e=>{k("editColumnConfirm",e)};let Y=t("");let Z=t("");const ee=()=>{w.tableColumn.length<1?H.warning("没有数据无法导出"):Z.value.openDialog(w.dataExportData)},te=()=>{U.push({path:"/web/data-upload"})};let le=l({isShow:!1});const ie=e=>{le.isShow=!0,le.chosenListType=e,le=Object.assign(le,w.layoutConfig[e])},oe=e=>{k("changeColumnShow",e)},ae=e=>{k("editColumnConfirm",e)};let se=t("");const ne=()=>{se.value.openDialog({name:B(w.detailId),code:w.entityCode,defaultFilterSetting:w.defaultFilterSetting})},re=()=>{k("defaultFilterChange")};return v({editColumn:ie}),(e,t)=>{const l=i("ElIconDelete"),v=i("el-icon"),k=i("ElIconShare"),F=i("ElIconFolderChecked"),E=i("ElIconFolderDelete"),_=i("ElIconMemo"),B=i("ElIconPrinter"),H=i("ElIconDownload"),K=i("ElIconUpload"),W=i("ElIconEditPen"),pe=i("ElIconMoreFilled"),de=i("el-button"),me=i("el-popover");return o(),a(c,null,[s(me,{placement:"bottom",trigger:"click","popper-style":{padding:0}},{reference:n((()=>[s(de,{type:"primary",plain:""},{default:n((()=>[r(" 更多 "),s(v,{style:{transform:"rotate(90deg)"}},{default:n((()=>[s(pe)])),_:1})])),_:1})])),default:n((()=>[p("div",I,[D,p("div",{class:d(["pl-20 item",{"div-disabled":j.multipleSelection.length<1&&"list"==j.type}]),onClick:t[0]||(t[0]=e=>Q("del"))},[p("span",x,[s(v,null,{default:n((()=>[s(l)])),_:1})]),r(" 删除 ")],2),p("div",{class:d(["pl-20 item",{"div-disabled":j.multipleSelection.length<1&&"list"==j.type}]),onClick:t[1]||(t[1]=e=>Q("allocation"))},[p("span",L,[s(v,null,{default:n((()=>[s(k)])),_:1})]),r(" 分配 ")],2),p("div",{class:d(["pl-20 item",{"div-disabled":j.multipleSelection.length<1&&"list"==j.type}]),onClick:t[2]||(t[2]=e=>Q("share"))},[p("span",N,[s(v,null,{default:n((()=>[s(F)])),_:1})]),r(" 共享 ")],2),p("div",{class:d(["pl-20 item",{"div-disabled":j.multipleSelection.length<1&&"list"==j.type}]),onClick:t[3]||(t[3]=e=>Q("unShare"))},[p("span",R,[s(v,null,{default:n((()=>[s(E)])),_:1})]),r(" 取消共享 ")],2),"list"!=j.type?(o(),a("div",{key:0,class:"pl-20 item",onClick:t[4]||(t[4]=e=>{Y.value.openDialog({entityCode:w.entityCode,detailId:w.detailId})})},[p("span",A,[s(v,null,{default:n((()=>[s(_)])),_:1})]),r(" 报表 ")])):m("",!0),"list"!=j.type?(o(),a("div",{key:1,class:"pl-20 item",onClick:t[5]||(t[5]=e=>(()=>{let e=U.resolve("/web/Printer?entityId="+w.detailId+"&nameFieldName="+w.nameFieldName);window.open(e.href)})())},[p("span",z,[s(v,null,{default:n((()=>[s(B)])),_:1})]),r(" 打印 ")])):m("",!0),"list"==j.type?(o(),a(c,{key:2},[O,p("div",{class:"pl-20 item",onClick:ee},[p("span",M,[s(v,null,{default:n((()=>[s(H)])),_:1})]),r(" 数据导出 ")]),u(G).checkRole("r6011")?(o(),a("div",{key:0,class:"pl-20 item",onClick:te},[p("span",T,[s(v,null,{default:n((()=>[s(K)])),_:1})]),r(" 数据导入 ")])):m("",!0),q,p("div",{class:d(["pl-20 item",{"is-active":"SELF"==j.defaultColumnShow}]),onClick:t[7]||(t[7]=e=>oe("SELF"))},[r(" 自定义列显示 "),p("div",P,[p("span",{class:"icon-span edit-icon",onClick:t[6]||(t[6]=f((e=>ie("SELF")),["stop"]))},[s(v,null,{default:n((()=>[s(W)])),_:1})])])],2),p("div",{class:d(["pl-20 item",{"is-active":"ALL"==j.defaultColumnShow}]),onClick:t[9]||(t[9]=e=>oe("ALL"))},[r(" 默认列显示 "),u(G).checkRole("r6008")?(o(),a("div",V,[p("span",{class:"icon-span edit-icon",onClick:t[8]||(t[8]=f((e=>ie("ALL")),["stop"]))},[s(v,null,{default:n((()=>[s(W)])),_:1})])])):m("",!0)],2),u(G).checkRole("r6008")?(o(),a("div",$,"列表设置")):m("",!0),u(G).checkRole("r6008")?(o(),a("div",{key:2,class:"pl-20 item",onClick:ne},"默认查询设置")):m("",!0)],64)):m("",!0)])])),_:1}),u(le).isShow?(o(),y(g,{key:0,modelValue:u(le).isShow,"onUpdate:modelValue":t[10]||(t[10]=e=>u(le).isShow=e),editColumnDialog:u(le),onConfirm:ae},null,8,["modelValue","editColumnDialog"])):m("",!0),s(h,{ref_key:"dataExportRefs",ref:Z},null,512),s(C,{ref_key:"allocationRefs",ref:J,idFieldName:j.idFieldName,onAllocationSuccess:X,entityCode:j.entityCode},null,8,["idFieldName","entityCode"]),s(b,{ref_key:"reportFormsRefs",ref:Y},null,512),s(S,{ref_key:"defaultFilterRefs",ref:se,onDefaultFilterChange:re},null,512)],64)}}},[["__scopeId","data-v-b450bdee"]]);export{B as default};
