import{_ as e}from"./vue3-manner-report-313033e6.js";import{j as t,s as r}from"./index-ea085229.js";import{u as o}from"./vue-router-414ebc36.js";import{R as s,r as i,s as a,a1 as l,Y as n,X as m,E as p,o as u,a as d,i as j,f as c}from"./@vue-1ad4818c.js";import"./element-plus-bab58d46.js";import"./lodash-es-b8e8104a.js";import"./@vueuse-477b4dbb.js";import"./@element-plus-2a6d398c.js";import"./@babel-6bd44fd1.js";import"./@popperjs-b78c3215.js";import"./@ctrl-4982d949.js";import"./dayjs-7fb79ad3.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./escape-html-3148dbc9.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-0ef99041.js";import"./axios-85bcd05e.js";import"./crypto-js-43a3a23e.js";import"./cron-parser-1391a961.js";import"./luxon-b01799b6.js";import"./nprogress-c04e6182.js";import"./pinia-3f60a8e1.js";import"./sortablejs-2f5483e3.js";import"./qrcodejs2-fix-bab07f30.js";import"./moment-bafe441d.js";import"./pinyin-pro-c81f5d39.js";import"./vue-i18n-0843b5c5.js";import"./@intlify-2528d766.js";import"./source-map-b06bd4b9.js";import"./vue-c723f8b1.js";import"./pinia-plugin-persistedstate-d2bd58cf.js";import"./resize-observer-polyfill-ad543aa3.js";import"./vue-smart-widget-8b3f5b0a.js";import"./echarts-b5d24e9a.js";import"./zrender-a15b073b.js";import"./tslib-a4e99503.js";import"./echarts-liquidfill-f5c863f1.js";import"./@antv-43d380be.js";import"./ant-design-vue-2db0c9af.js";import"./@ant-design-60f2ef8e.js";import"./vue-types-6bcea8eb.js";import"./dom-align-78cb5391.js";import"./vue-draggable-next-a413f884.js";import"./vue-resize-observer-90aea344.js";const v=["element-loading-text"],f={__name:"luckysheet",setup(f){const y=s("$ElMessage"),g=o();let h=i(!1),w=i("数据加载中..."),b=i(!1),_=i(""),C=i(""),x=i([]),N=a([{name:"Cell",color:"",index:0,status:1,order:0,hide:0,row:40,column:20,defaultRowHeight:19,defaultColWidth:73,celldata:[],config:{merge:{},rowlen:{},columnlen:{},rowhidden:{},colhidden:{},borderInfo:[],authority:{}},scrollLeft:0,scrollTop:0,luckysheet_select_save:[],calcChain:[],isPivotTable:!1,pivotTable:{},filter_select:{},filter:null,luckysheet_alternateformat_save:[],luckysheet_alternateformat_save_modelCustom:[],luckysheet_conditionformat_save:{},frozen:{},chart:[],zoomRatio:1,image:[],showGridLines:1,dataVerification:{}}]),z=i(),k=i("");function I(){return new Promise((async(e,r)=>{let o=await t.get("/plugins/mannerReport/getEntityList",{reportConfigId:_.value});if(o){let e=o.data||[];x.value=e}e()}))}function J(){return new Promise((async(e,r)=>{let o=await t.get("/crud/queryById",{entityId:_.value,fieldNames:"reportConfigId,reportName,reportJson,entityCode"});if(o){let e=o.data,t=JSON.parse(e.reportJson);C.value=e.entityCode,k.value=e.reportName,z.value=t||N.value}e()}))}async function L(e){h.value=!0,w.value="保存中...";let t={entity:"ReportConfig",id:_.value,formModel:{reportName:e.reportName,reportJson:e.reportJson,entityCode:C.value}};await r(t.entity,t.id,t.formModel)&&y.success("保存成功"),h.value=!1,w.value="加载中..."}return l((()=>{_.value=g.currentRoute.value.query.reportConfigId,h.value=!0,Promise.all([I(),J()]).then((()=>{h.value=!1,b.value=!0}))})),(t,r)=>{const o=n("loading");return m((u(),d("div",{"data-1684916215247":"","element-loading-text":p(w),class:"w-100"},[p(b)?(u(),j(p(e),{key:0,onOnSave:L,reportName:p(k),dbList:p(x),sheets:p(z)},null,8,["reportName","dbList","sheets"])):c("",!0)],8,v)),[[o,p(h)]])}}};export{f as default};
