import{R as e,r as a,u as l,p as t,l as n,Y as o,X as s,E as i,o as u,a as d,c,w as m,z as v,i as g,f as p,F as C,A as r}from"./@vue-1ad4818c.js";const f={class:"action-div"},b={__name:"autoAllocation",props:{modelValue:null},setup(b){const y=b,V=e("$API");e("$ElMessage");let _=a(!1),T=a({actionContent:{}});l((()=>T.value.whenNum),(()=>{(16&T.value.whenNum)>0&&2==T.value.actionContent.assignType&&(T.value.actionContent.assignType=1)}),{deep:!0});let h=a([]);t((()=>{T.value=y.modelValue,T.value.actionContent.assignType||(T.value.actionContent.assignType=2),T.value.actionContent.assignRule||(T.value.actionContent.assignRule=1),T.value.actionContent.cascades||(T.value.actionContent.cascades=[]),w()}));const w=async()=>{var e;_.value=!0;let a=await V.trigger.detial.getAssignEntityList(T.value.entityCode);if(a)if(h.value=a.data,(null==(e=T.value.actionContent.assignTo)?void 0:e.length)>0){let e=await V.trigger.detial.idToIdName(T.value.actionContent.assignTo);e&&(T.value.actionContent.allocationWhos=e.data)}else T.value.actionContent.allocationWhos=[];_.value=!1};return(e,a)=>{const l=n("el-radio"),t=n("el-radio-group"),b=n("el-form-item"),y=n("mlSelectUser"),V=n("el-option"),w=n("el-select"),R=o("loading");return s((u(),d("div",f,[c(b,{label:"分配类型"},{default:m((()=>[c(t,{modelValue:i(T).actionContent.assignType,"onUpdate:modelValue":a[0]||(a[0]=e=>i(T).actionContent.assignType=e)},{default:m((()=>[c(l,{label:1},{default:m((()=>[v("跟随主实体")])),_:1}),c(l,{label:2,disabled:(16&i(T).whenNum)>0,title:"分配时 触发不支持 自定义"},{default:m((()=>[v("自定义")])),_:1},8,["disabled"])])),_:1},8,["modelValue"])])),_:1}),2==i(T).actionContent.assignType?(u(),g(b,{key:0,class:"mt-20",label:"分配给谁"},{default:m((()=>[c(y,{modelValue:i(T).actionContent.allocationWhos,"onUpdate:modelValue":a[1]||(a[1]=e=>i(T).actionContent.allocationWhos=e),multiple:"",clearable:""},null,8,["modelValue"])])),_:1})):p("",!0),2==i(T).actionContent.assignType?(u(),g(b,{key:1,class:"mt-20",label:"(多人)分配规则"},{default:m((()=>[c(t,{modelValue:i(T).actionContent.assignRule,"onUpdate:modelValue":a[2]||(a[2]=e=>i(T).actionContent.assignRule=e)},{default:m((()=>[c(l,{label:1},{default:m((()=>[v("依次平均分配")])),_:1}),c(l,{label:2},{default:m((()=>[v("随机分配")])),_:1})])),_:1},8,["modelValue"])])),_:1})):p("",!0),c(b,{class:"mt-20",label:"同时分配关联记录"},{default:m((()=>[c(w,{modelValue:i(T).actionContent.cascades,"onUpdate:modelValue":a[3]||(a[3]=e=>i(T).actionContent.cascades=e),multiple:"",placeholder:"选择关联实体",style:{width:"100%"},clearable:"",filterable:"","value-key":"label"},{default:m((()=>[(u(!0),d(C,null,r(i(h),((e,a)=>(u(),g(V,{key:a,value:e,label:e.label},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])])),_:1})])),[[R,i(_)]])}}};export{b as default};
