import{u as t}from"./vue-router-414ebc36.js";import{_ as e,f as o,h as r,q as i}from"./index-ea085229.js";import{r as n,p as s,n as a,l,Y as m,o as u,a as p,X as c,E as d,g as v,t as f,i as j,f as y}from"./@vue-1ad4818c.js";import"./element-plus-bab58d46.js";import"./lodash-es-b8e8104a.js";import"./@vueuse-477b4dbb.js";import"./@element-plus-2a6d398c.js";import"./@babel-6bd44fd1.js";import"./@popperjs-b78c3215.js";import"./@ctrl-4982d949.js";import"./dayjs-7fb79ad3.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./escape-html-3148dbc9.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-0ef99041.js";import"./vue3-manner-report-313033e6.js";import"./axios-85bcd05e.js";import"./crypto-js-43a3a23e.js";import"./cron-parser-1391a961.js";import"./luxon-b01799b6.js";import"./nprogress-c04e6182.js";import"./pinia-3f60a8e1.js";import"./sortablejs-2f5483e3.js";import"./qrcodejs2-fix-bab07f30.js";import"./moment-bafe441d.js";import"./pinyin-pro-c81f5d39.js";import"./vue-i18n-0843b5c5.js";import"./@intlify-2528d766.js";import"./source-map-b06bd4b9.js";import"./vue-c723f8b1.js";import"./pinia-plugin-persistedstate-d2bd58cf.js";import"./resize-observer-polyfill-ad543aa3.js";import"./vue-smart-widget-8b3f5b0a.js";import"./echarts-b5d24e9a.js";import"./zrender-a15b073b.js";import"./tslib-a4e99503.js";import"./echarts-liquidfill-f5c863f1.js";import"./@antv-43d380be.js";import"./ant-design-vue-2db0c9af.js";import"./@ant-design-60f2ef8e.js";import"./vue-types-6bcea8eb.js";import"./dom-align-78cb5391.js";import"./vue-draggable-next-a413f884.js";import"./vue-resize-observer-90aea344.js";const h=function(t,e){if(!(this instanceof h))return new h(t,e);if(this.options=this.extend({noPrint:".no-print"},e),"string"==typeof t)try{this.dom=document.querySelector(t)}catch{var o=document.createElement("div");o.innerHTML=t,this.dom=o}else this.isDOM(t),this.dom=this.isDOM(t)?t:t.$el;this.init()};h.prototype={init:function(){var t=this.getStyle()+this.getHtml();this.writeIframe(t)},extend:function(t,e){for(var o in e)t[o]=e[o];return t},getStyle:function(){for(var t="",e=document.querySelectorAll("style,link"),o=0;o<e.length;o++)t+=e[o].outerHTML;return t+="<style>"+(this.options.noPrint?this.options.noPrint:".no-print")+"{display:none;}</style>",t+="<style>html,body{background-color:#fff;}</style>"},getHtml:function(){for(var t=document.querySelectorAll("input"),e=document.querySelectorAll("textarea"),o=document.querySelectorAll("select"),r=0;r<t.length;r++)"checkbox"==t[r].type||"radio"==t[r].type?1==t[r].checked?t[r].setAttribute("checked","checked"):t[r].removeAttribute("checked"):(t[r].type,t[r].setAttribute("value",t[r].value));for(var i=0;i<e.length;i++)"textarea"==e[i].type&&(e[i].innerHTML=e[i].value);for(var n=0;n<o.length;n++)if("select-one"==o[n].type){var s=o[n].children;for(var a in s)"OPTION"==s[a].tagName&&(1==s[a].selected?s[a].setAttribute("selected","selected"):s[a].removeAttribute("selected"))}return this.dom.outerHTML},writeIframe:function(t){var e,o,r=document.createElement("iframe"),i=document.body.appendChild(r);r.id="myIframe",r.setAttribute("style","position:absolute;width:0;height:0;top:-10px;left:-10px;"),e=i.contentWindow||i.contentDocument,(o=i.contentDocument||i.contentWindow.document).open(),o.write(t),o.close();var n=this;r.onload=function(){n.toPrint(e),setTimeout((function(){document.body.removeChild(r)}),100)}},toPrint:function(t){try{setTimeout((function(){t.focus();try{t.document.execCommand("print",!1,null)||t.print()}catch(e){t.print()}t.close()}),10)}catch(e){}},isDOM:"object"==typeof HTMLElement?function(t){return t instanceof HTMLElement}:function(t){return t&&"object"==typeof t&&1===t.nodeType&&"string"==typeof t.nodeName}};const g={class:"printer"},b={class:"printer-content"},x={style:{"font-size":"16px","font-weight":"bold","text-align":"center","margin-bottom":"20px"}},w={class:"v-from-box"},q=e({__name:"Printer",setup(e){const{queryEntityNameById:q}=o(),A=t();let M=n(""),k=n({}),T=n(!1),D=n(!1),H=n(""),I=n("");s((()=>{M.value=A.currentRoute.value.query.entityId,H.value=A.currentRoute.value.query.nameFieldName,M.value&&A.go(-1),z()}));let S=n();n();const z=async()=>{var t;D.value=!0;let e=await r(q(M.value));T.value=!1,e&&(null==(t=e.data)?void 0:t.layoutJson)&&(T.value=!0,k.value=e.data.optionData||{},a((async()=>{let t=await i(M.value);if(t&&t.data){S.value.setFormJson(e.data.layoutJson);let o=t.data||{};I.value=o[H.value],S.value.resetForm(),S.value.setFormData(o),a((()=>{"{}"==JSON.stringify(k.value)&&S.value.reloadOptionData(),S.value.setReadMode(),h(".printer-content")}))}}))),D.value=!1};return(t,e)=>{const o=l("v-form-render"),r=m("loading");return u(),p("div",g,[c((u(),p("div",b,[v("div",x,f(d(I)),1),v("div",w,[d(T)?(u(),j(o,{key:0,"option-data":d(k),ref_key:"vFormRef",ref:S},null,8,["option-data"])):y("",!0)])])),[[r,d(D)]])])}}},[["__scopeId","data-v-ab2d8626"]]);export{q as default};
