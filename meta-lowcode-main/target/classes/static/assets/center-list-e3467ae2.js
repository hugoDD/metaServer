import{$ as e}from"./index-ea085229.js";import{m as t,a}from"./ApprovalRelated-e5fb019d.js";import{D as r}from"./detail-5eb8c530.js";import{R as o,v as l,r as i,a1 as p,l as s,o as m,a as n,c as d,w as u,i as v,z as j,f,E as y,G as c,F as I}from"./@vue-1ad4818c.js";import"./element-plus-bab58d46.js";import"./lodash-es-b8e8104a.js";import"./@vueuse-477b4dbb.js";import"./@element-plus-2a6d398c.js";import"./@babel-6bd44fd1.js";import"./@popperjs-b78c3215.js";import"./@ctrl-4982d949.js";import"./dayjs-7fb79ad3.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./escape-html-3148dbc9.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-0ef99041.js";import"./vue3-manner-report-313033e6.js";import"./axios-85bcd05e.js";import"./crypto-js-43a3a23e.js";import"./cron-parser-1391a961.js";import"./luxon-b01799b6.js";import"./vue-router-414ebc36.js";import"./nprogress-c04e6182.js";import"./pinia-3f60a8e1.js";import"./sortablejs-2f5483e3.js";import"./qrcodejs2-fix-bab07f30.js";import"./moment-bafe441d.js";import"./pinyin-pro-c81f5d39.js";import"./vue-i18n-0843b5c5.js";import"./@intlify-2528d766.js";import"./source-map-b06bd4b9.js";import"./vue-c723f8b1.js";import"./pinia-plugin-persistedstate-d2bd58cf.js";import"./resize-observer-polyfill-ad543aa3.js";import"./vue-smart-widget-8b3f5b0a.js";import"./echarts-b5d24e9a.js";import"./zrender-a15b073b.js";import"./tslib-a4e99503.js";import"./echarts-liquidfill-f5c863f1.js";import"./@antv-43d380be.js";import"./ant-design-vue-2db0c9af.js";import"./@ant-design-60f2ef8e.js";import"./vue-types-6bcea8eb.js";import"./dom-align-78cb5391.js";import"./vue-draggable-next-a413f884.js";import"./vue-resize-observer-90aea344.js";import"./DetailTabs-e3a61e27.js";import"./DetailTabsSet-9cda58dd.js";import"./More-47f7037c.js";import"./SetColumn-15f4404b.js";import"./DataExport-cabbbed3.js";import"./Allocation-359987ff.js";import"./ReportForms-7661dfe6.js";import"./DefaultFilterDialog-f7a53bd1.js";import"./FormatRow-d4305ec1.js";import"./edit-dfd0882d.js";import"./team-3e46d8bc.js";import"./NewRelated-d601bf33.js";import"./CardLayout-74c0bddb.js";const g={key:0},b={key:1},k={__name:"center-list",props:{type:{type:String,default:""}},setup(k){const C=o("$TOOL");let w=l({}),h=i();p((()=>{const e=C.data.get("USER_INFO");w={handle:{title:"待我处理",value:1,filterItems:[{fieldName:"approver",op:"REF",value:"approvalTaskId",value2:e.userId}]},submit:{title:"我提交的",value:2,filterItems:[{fieldName:"createdBy",op:"EQ",value:e.userId}]},cc:{title:"抄送我的",value:3,filterItems:[{fieldName:"ccTo",op:"REF",value:"approvalTaskId",value2:e.userId}]}}}));let N=i(!1),T=i(""),S=i(""),R=i(""),D=i("");i([{fieldName:"modifiedOn",type:"DESC"}]);let z=i([{prop:"approvalConfigId.flowName",label:"流程名称",formatter:e=>e["approvalConfigId.flowName"]||e.stepName},{prop:"entityId.name",label:"关联记录",highlight:!0,formatter:e=>{var t;return null==(t=e.entityId)?void 0:t.name}},{prop:"remark",label:"最近审批备注"},{prop:"approvalStatus.label",label:"审批状态",width:"120",align:"center",formatter:e=>{var t;return null==(t=e.approvalStatus)?void 0:t.label}},{prop:"approver",label:"最近审核人",width:"150",align:"center",formatter:e=>{var t;return null==(t=e.approvalUser)?void 0:t.name}},{prop:"approvalOn",label:"最近审批时间",width:"120",align:"center",formatter:t=>e(t.approvalOn)}]);function E(){h.value.getTableList()}let _=i(!1);let x=i("");const F=e=>{x.value.openDialog(e.entityId.id)};return(e,o)=>{const l=s("el-button"),i=s("el-table-column"),p=s("mlEntityMenuAndList");return m(),n(I,null,[d(p,{title:y(w)[k.type].title,entityName:"ApprovalTask",fieldsList:"approvalTaskId,approvalConfigId,entityId,approvalOn,remark,approvalStatus,approvalConfigId.flowName,approvalUser,stepName,approvalConfigId.entityCode",defalutSortField:"modifiedOn",tableColumn:y(z),filterItems:y(w)[k.type].filterItems,ref_key:"mlSingleListRef",ref:h,onGoDetial:F,fieldName:"approvalConfigId.entityCode",queryUrl:"/approval/listQuery",approvalTaskType:y(w)[k.type].value},{activeRow:u((()=>["handle"===k.type||"cc"===k.type?(m(),v(i,{label:"操作",align:"center",width:"160",key:"1",fixed:"right"},{default:u((e=>[d(l,{size:"small",link:"",onClick:t=>{return a=e.row,_.value=!0,void(S.value=a.entityId.id);var a},type:"primary"},{default:u((()=>[j("审批历史")])),_:2},1032,["onClick"]),"cc"!=k.type?(m(),v(l,{key:0,link:"",disabled:!(e.row.approvalStatus&&1===e.row.approvalStatus.value),size:"small",type:"success",onClick:t=>{return a=e.row,N.value=!0,T.value=a.approvalTaskId,S.value=a.entityId.id,D.value=a.entityId.name,void(R.value=a["approvalConfigId.entityCode"]);var a}},{default:u((()=>[j("审批")])),_:2},1032,["disabled","onClick"])):f("",!0)])),_:1})):f("",!0)])),_:1},8,["title","tableColumn","filterItems","approvalTaskType"]),y(N)?(m(),n("div",g,[d(t,{modelValue:y(N),"onUpdate:modelValue":o[0]||(o[0]=e=>c(N)?N.value=e:N=e),taskId:y(T),entityId:y(S),approvalName:y(D),onConfirm:E,title:"审批"},null,8,["modelValue","taskId","entityId","approvalName"])])):f("",!0),y(_)?(m(),n("div",b,[d(a,{modelValue:y(_),"onUpdate:modelValue":o[1]||(o[1]=e=>c(_)?_.value=e:_=e),entityId:y(S),onConfirm:E,title:"审批历史"},null,8,["modelValue","entityId"])])):f("",!0),d(r,{ref_key:"detailRefs",ref:x},null,512)],64)}}};export{k as default};
