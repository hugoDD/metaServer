import{f as e,_ as o}from"./index-ea085229.js";import{l as s,o as r,i as t,w as i,c as a,z as l,t as m,ag as p}from"./@vue-1ad4818c.js";import"./element-plus-bab58d46.js";import"./lodash-es-b8e8104a.js";import"./@vueuse-477b4dbb.js";import"./@element-plus-2a6d398c.js";import"./@babel-6bd44fd1.js";import"./@popperjs-b78c3215.js";import"./@ctrl-4982d949.js";import"./dayjs-7fb79ad3.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./escape-html-3148dbc9.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-0ef99041.js";import"./vue3-manner-report-313033e6.js";import"./axios-85bcd05e.js";import"./crypto-js-43a3a23e.js";import"./cron-parser-1391a961.js";import"./luxon-b01799b6.js";import"./vue-router-414ebc36.js";import"./nprogress-c04e6182.js";import"./pinia-3f60a8e1.js";import"./sortablejs-2f5483e3.js";import"./qrcodejs2-fix-bab07f30.js";import"./moment-bafe441d.js";import"./pinyin-pro-c81f5d39.js";import"./vue-i18n-0843b5c5.js";import"./@intlify-2528d766.js";import"./source-map-b06bd4b9.js";import"./vue-c723f8b1.js";import"./pinia-plugin-persistedstate-d2bd58cf.js";import"./resize-observer-polyfill-ad543aa3.js";import"./vue-smart-widget-8b3f5b0a.js";import"./echarts-b5d24e9a.js";import"./zrender-a15b073b.js";import"./tslib-a4e99503.js";import"./echarts-liquidfill-f5c863f1.js";import"./@antv-43d380be.js";import"./ant-design-vue-2db0c9af.js";import"./@ant-design-60f2ef8e.js";import"./vue-types-6bcea8eb.js";import"./dom-align-78cb5391.js";import"./vue-draggable-next-a413f884.js";import"./vue-resize-observer-90aea344.js";const{getEntityList:n}=e();const u=o({data(){return{userType:"admin",form:{user:"",password:"",autologin:!1},rules:{user:[{required:!0,message:this.$t("login.userError"),trigger:"blur"}],password:[{required:!0,message:this.$t("login.PWError"),trigger:"blur"}]},islogin:!1}},watch:{userType(e){"admin"==e?(this.form.user="admin",this.form.password="admin"):"user"==e&&(this.form.user="test006",this.form.password="123456")}},mounted(){let e=this.$TOOL.cookie.get("userInfo");e&&(e=JSON.parse(e),this.form.user=e.loginName,this.form.password=e.password,this.form.autologin=e.autologin)},methods:{async login(){if(!(await this.$refs.loginForm.validate().catch((()=>{}))))return!1;var e={user:this.form.user,password:this.form.password},o=await this.$API.auth.token.post(e);if(o){let e={userName:o.data.name,loginName:this.form.user,userId:o.data.id,dashboard:"1"};this.$TOOL.data.set("USER_INFO",e),this.$TOOL.cookie.remove("userInfo"),this.form.autologin&&(e.password=this.form.password,e.autologin=this.form.autologin,this.$TOOL.cookie.set("userInfo",JSON.stringify(e),{expires:259200})),sessionStorage.setItem("userId",o.data.id),this.$TOOL.cookie.set("uid",o.data,{expires:259200}),n(),this.$router.replace({path:"/"}),this.$message.success("登录成功")}this.islogin=!1}}},[["render",function(e,o,n,u,d,f){const j=s("el-input"),g=s("el-form-item"),h=s("el-checkbox"),c=s("el-col"),w=s("el-button"),v=s("el-form");return r(),t(v,{ref:"loginForm",model:d.form,rules:d.rules,"label-width":"0",size:"large",onKeyup:p(f.login,["enter"])},{default:i((()=>[a(g,{prop:"user"},{default:i((()=>[a(j,{modelValue:d.form.user,"onUpdate:modelValue":o[0]||(o[0]=e=>d.form.user=e),"prefix-icon":"el-icon-user",clearable:"",placeholder:e.$t("login.userPlaceholder")},null,8,["modelValue","placeholder"])])),_:1}),a(g,{prop:"password"},{default:i((()=>[a(j,{modelValue:d.form.password,"onUpdate:modelValue":o[1]||(o[1]=e=>d.form.password=e),"prefix-icon":"el-icon-lock",clearable:"","show-password":"",placeholder:e.$t("login.PWPlaceholder")},null,8,["modelValue","placeholder"])])),_:1}),a(g,{style:{"margin-bottom":"10px"}},{default:i((()=>[a(c,{span:12},{default:i((()=>[a(h,{label:"记住密码",modelValue:d.form.autologin,"onUpdate:modelValue":o[2]||(o[2]=e=>d.form.autologin=e)},null,8,["modelValue"])])),_:1})])),_:1}),a(g,null,{default:i((()=>[a(w,{type:"primary",style:{width:"100%"},loading:d.islogin,round:"",onClick:f.login},{default:i((()=>[l(m(e.$t("login.signIn")),1)])),_:1},8,["loading","onClick"])])),_:1})])),_:1},8,["model","rules","onKeyup"])}]]);export{u as default};
