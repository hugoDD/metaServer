import{l as e,o as l,a as t,c as a,f as n,F as i,A as o,i as s,w as c,g as u,t as d,a0 as r,ac as m,j as p,Y as f,X as h,W as v,z as g,C as y,bh as b,bf as k,e as _,U as C,r as x,u as w,p as I,E as V,G as T,R as L,v as O,$ as M,aD as N}from"./@vue-1ad4818c.js";import{_ as E,f as j,I as $,aG as F,aB as S,$ as U,j as P,aH as A}from"./index-ea085229.js";import{s as D,d as z}from"./pinia-3f60a8e1.js";import{S as R}from"./sortablejs-2f5483e3.js";import{u as G,a as q}from"./iframe-ae5307d6.js";import{u as B}from"./vue-router-414ebc36.js";import{D as H}from"./detail-5eb8c530.js";import{m as J}from"./ApprovalRelated-e5fb019d.js";import{V as W}from"./vue-draggable-next-a413f884.js";import{b as Y,d as K}from"./element-plus-bab58d46.js";import{m as X}from"./index-d8f1c29f.js";import"./vue3-manner-report-313033e6.js";import"./axios-85bcd05e.js";import"./crypto-js-43a3a23e.js";import"./@babel-6bd44fd1.js";import"./cron-parser-1391a961.js";import"./luxon-b01799b6.js";import"./nprogress-c04e6182.js";import"./qrcodejs2-fix-bab07f30.js";import"./@element-plus-2a6d398c.js";import"./moment-bafe441d.js";import"./pinyin-pro-c81f5d39.js";import"./vue-i18n-0843b5c5.js";import"./@intlify-2528d766.js";import"./source-map-b06bd4b9.js";import"./vue-c723f8b1.js";import"./@vueuse-477b4dbb.js";import"./pinia-plugin-persistedstate-d2bd58cf.js";import"./resize-observer-polyfill-ad543aa3.js";import"./vue-smart-widget-8b3f5b0a.js";import"./echarts-b5d24e9a.js";import"./zrender-a15b073b.js";import"./tslib-a4e99503.js";import"./echarts-liquidfill-f5c863f1.js";import"./@antv-43d380be.js";import"./ant-design-vue-2db0c9af.js";import"./lodash-es-b8e8104a.js";import"./@ant-design-60f2ef8e.js";import"./@ctrl-4982d949.js";import"./dayjs-7fb79ad3.js";import"./vue-types-6bcea8eb.js";import"./dom-align-78cb5391.js";import"./vue-resize-observer-90aea344.js";import"./@popperjs-b78c3215.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./escape-html-3148dbc9.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-0ef99041.js";import"./DetailTabs-e3a61e27.js";import"./DetailTabsSet-9cda58dd.js";import"./More-47f7037c.js";import"./SetColumn-15f4404b.js";import"./DataExport-cabbbed3.js";import"./Allocation-359987ff.js";import"./ReportForms-7661dfe6.js";import"./DefaultFilterDialog-f7a53bd1.js";import"./FormatRow-d4305ec1.js";import"./edit-dfd0882d.js";import"./team-3e46d8bc.js";import"./NewRelated-d601bf33.js";import"./CardLayout-74c0bddb.js";const Q={key:0,style:{padding:"20px"}},Z=["href","target","onClick"],ee={key:0,class:"menu-tag"},le={key:1,class:"menu-tag"};const te=E({name:"NavMenu",props:["navMenus"],data:()=>({}),methods:{hasChildren:e=>e.children&&!e.children.every((e=>e.meta.hidden))}},[["render",function(f,h,v,g,y,b){const k=e("el-alert"),_=e("NavMenu",!0),C=e("el-menu-item-group"),x=e("el-icon"),w=e("el-menu-item"),I=e("el-sub-menu");return l(),t(i,null,[v.navMenus.length<=0?(l(),t("div",Q,[a(k,{title:"无子集菜单",center:"",type:"info",closable:!1})])):n("",!0),(l(!0),t(i,null,o(v.navMenus,(e=>(l(),t(i,{key:e},[e.meta&&e.meta.group?(l(),s(C,{key:0},{title:c((()=>[u("span",null,d(e.meta.title),1)])),default:c((()=>[a(_,{navMenus:e.children},null,8,["navMenus"])])),_:2},1024)):b.hasChildren(e)?(l(),s(I,{key:2,index:e.path||e.name},{title:c((()=>[e.meta&&e.meta.icon?(l(),s(x,{key:0,style:m({color:e.meta.iconColor})},{default:c((()=>[(l(),s(p(e.meta.icon||"el-icon-menu")))])),_:2},1032,["style"])):n("",!0),u("span",null,d(e.meta.title),1),e.meta.tag?(l(),t("span",le,d(e.meta.tag),1)):n("",!0)])),default:c((()=>[a(_,{navMenus:e.children},null,8,["navMenus"])])),_:2},1032,["index"])):(l(),s(w,{key:1,index:e.path},{title:c((()=>[u("span",null,d(e.meta.title),1),e.meta.tag?(l(),t("span",ee,d(e.meta.tag),1)):n("",!0)])),default:c((()=>[e.meta&&"link"==e.meta.type?(l(),t("a",{key:0,href:e.meta.outLink,target:0==e.meta.outLink.indexOf("/")?"":"_blank",onClick:r((()=>{}),["stop"])},null,8,Z)):n("",!0),e.meta&&e.meta.icon?(l(),s(x,{key:1,style:m({color:e.meta.iconColor})},{default:c((()=>[(l(),s(p(e.meta.icon||"el-icon-menu")))])),_:2},1032,["style"])):n("",!0)])),_:2},1032,["index"]))],64)))),128))],64)}]]),{publicSetting:ae}=D(j()),ne={class:"logo-bar"};const ie=E({components:{NavMenu:te},data:()=>({nav:!1,menu:[]}),computed:{appName:()=>ae.value.APP_NAME},created(){var e=this.$router.sc_getMenu();this.menu=this.filterUrl(e)},watch:{},methods:{showMobileNav(e){if("true"==e.currentTarget.getAttribute("drag-flag"))return!1;this.nav=!0},select(){this.$refs.mobileNavBox.handleClose()},filterUrl(e){var l=[];return e&&e.forEach((e=>{if(e.meta=e.meta?e.meta:{},e.meta.hidden||"button"==e.meta.type)return!1;"iframe"==e.meta.type&&(e.path=`/i/${e.name}`),e.children&&e.children.length>0&&(e.children=this.filterUrl(e.children)),l.push(e)})),l}},directives:{drag(e){let l=e,t="",a="";l.onmousedown=function(e){let n=e.clientX-l.offsetLeft,i=e.clientY-l.offsetTop;return document.onmousemove=function(e){l.setAttribute("drag-flag",!0),t=(new Date).getTime();let a=e.clientX-n,o=e.clientY-i;o>0&&o<document.body.clientHeight-50&&(l.style.top=o+"px"),a>0&&a<document.body.clientWidth-50&&(l.style.left=a+"px")},document.onmouseup=function(){a=(new Date).getTime(),a-t>200&&l.setAttribute("drag-flag",!1),document.onmousemove=null,document.onmouseup=null},!1}}}},[["render",function(n,o,s,r,m,p){const v=e("el-icon-menu"),g=e("el-icon"),y=e("mlLogo"),b=e("el-header"),k=e("NavMenu"),_=e("el-menu"),C=e("el-scrollbar"),x=e("el-main"),w=e("el-container"),I=e("el-drawer"),V=f("drag");return l(),t(i,null,[h((l(),t("div",{ref:"",class:"mobile-nav-button",onClick:o[0]||(o[0]=e=>p.showMobileNav(e)),draggable:"false"},[a(g,null,{default:c((()=>[a(v)])),_:1})])),[[V]]),a(I,{ref:"mobileNavBox",title:"移动端菜单",size:240,modelValue:m.nav,"onUpdate:modelValue":o[1]||(o[1]=e=>m.nav=e),direction:"ltr","with-header":!1,"destroy-on-close":""},{default:c((()=>[a(w,{class:"mobile-nav"},{default:c((()=>[a(b,null,{default:c((()=>[u("div",ne,[a(y,{class:"logo"}),u("span",null,d(p.appName),1)])])),_:1}),a(x,null,{default:c((()=>[a(C,null,{default:c((()=>[a(_,{"default-active":n.$route.meta.active||n.$route.fullPath,onSelect:p.select,router:"","background-color":"#212d3d","text-color":"#fff","active-text-color":"#409EFF"},{default:c((()=>[a(k,{navMenus:m.menu},null,8,["navMenus"])])),_:1},8,["default-active","onSelect"])])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}],["__scopeId","data-v-01898806"]]),oe={data:()=>({breadList:[]}),created(){this.getBreadcrumb()},watch:{$route(){this.getBreadcrumb()}},methods:{getBreadcrumb(){let e=this.$route.meta.breadcrumb;this.breadList=e}}},se={class:"adminui-topbar"},ce={class:"left-panel"},ue=(e=>(b("data-v-fe2e0381"),e=e(),k(),e))((()=>u("div",{class:"center-panel"},null,-1))),de={class:"right-panel"};const re=E(oe,[["render",function(r,m,f,h,b,k){const _=e("el-icon"),C=e("el-breadcrumb-item"),x=e("el-breadcrumb");return l(),t("div",se,[u("div",ce,[a(x,{"separator-icon":"el-icon-arrow-right",class:"hidden-sm-and-down"},{default:c((()=>[a(v,{name:"breadcrumb"},{default:c((()=>[(l(!0),t(i,null,o(b.breadList,((e,a)=>(l(),t(i,{key:a},["/"==e.path||e.meta.hiddenBreadcrumb?n("",!0):(l(),s(C,{key:e.meta.title},{default:c((()=>[e.meta.icon?(l(),s(_,{key:0,class:"icon"},{default:c((()=>[(l(),s(p(e.meta.icon)))])),_:2},1024)):n("",!0),g(d(e.meta.title),1)])),_:2},1024))],64)))),128))])),_:1})])),_:1})]),ue,u("div",de,[y(r.$slots,"default",{},void 0,!0)])])}],["__scopeId","data-v-fe2e0381"]]),me=$(),pe=G(),fe=q(),{viewTags:he}=D(me),{pushViewTags:ve,removeViewTags:ge}=me,{pushKeepLive:ye,removeKeepLive:be,setRouteShow:ke}=pe,{removeIframeList:_e,refreshIframe:Ce}=fe,xe={name:"tags",data:()=>({contextMenuVisible:!1,contextMenuItem:null,left:0,top:0,tagList:he.value,tipDisplayed:!1}),props:{},watch:{$route(e){this.addViewTags(e),this.$nextTick((()=>{const e=this.$refs.tags;if(e&&e.scrollWidth>e.clientWidth){e.querySelector(".active").scrollIntoView(),this.tipDisplayed||(this.$msgbox({type:"warning",center:!0,title:"提示",message:"当前标签数量过多，可通过鼠标滚轴滚动标签栏。关闭标签数量可减少系统性能消耗。",confirmButtonText:"知道了"}),this.tipDisplayed=!0)}}))},contextMenuVisible(e){const l=e=>{const l=document.getElementById("contextmenu");l&&!l.contains(e.target)&&this.closeMenu()};e?document.body.addEventListener("click",(e=>l(e))):document.body.removeEventListener("click",(e=>l(e)))}},created(){var e=this.$router.sc_getMenu(),l=this.treeFind(e,(e=>e.path==this.$CONFIG.DASHBOARD_URL));l&&(l.fullPath=l.path,this.addViewTags(l),this.addViewTags(this.$route))},mounted(){this.tagDrop(),this.scrollInit()},methods:{treeFind(e,l){for(const t of e){if(l(t))return t;if(t.children){const e=this.treeFind(t.children,l);if(e)return e}}return null},tagDrop(){const e=this.$refs.tags;R.create(e,{draggable:"li",animation:300})},addViewTags(e){e.name&&!e.meta.fullpage&&(ve(e),ye(e.name))},isActive(e){return e.fullPath===this.$route.fullPath},closeSelectedTag(e,l=!0){const t=this.tagList.findIndex((l=>l.fullPath==e.fullPath));if(ge(e),_e(e),be(e.name),l&&this.isActive(e)){const e=this.tagList[t-1];e?this.$router.push(e):this.$router.push("/")}},openContextMenu(e,l){this.contextMenuItem=l,this.contextMenuVisible=!0,this.left=e.clientX+1,this.top=e.clientY+1,this.$nextTick((()=>{let l=document.getElementById("contextmenu");document.body.offsetWidth-e.clientX<l.offsetWidth&&(this.left=document.body.offsetWidth-l.offsetWidth+1,this.top=e.clientY+1)}))},closeMenu(){this.contextMenuItem=null,this.contextMenuVisible=!1},refreshTab(){this.contextMenuVisible=!1;const e=this.contextMenuItem;this.$route.fullPath!==e.fullPath&&this.$router.push({path:e.fullPath,query:e.query}),Ce(e),setTimeout((()=>{be(e.name),ke(!1),this.$nextTick((()=>{ye(e.name),ke(!0)}))}),0)},closeTabs(){var e=this.contextMenuItem;e.meta.affix||(this.closeSelectedTag(e),this.contextMenuVisible=!1)},closeOtherTabs(){var e=this.contextMenuItem;this.$route.fullPath!=e.fullPath&&this.$router.push({path:e.fullPath,query:e.query}),[...this.tagList].forEach((l=>{if(l.meta&&l.meta.affix||e.fullPath==l.fullPath)return!0;this.closeSelectedTag(l,!1)})),this.contextMenuVisible=!1},maximize(){var e=this.contextMenuItem;this.contextMenuVisible=!1,this.$route.fullPath!=e.fullPath&&this.$router.push({path:e.fullPath,query:e.query}),document.getElementById("app").classList.add("main-maximize")},openWindow(){var e=this.contextMenuItem,l=e.href||"/";e.meta.affix||this.closeSelectedTag(e),window.open(l),this.contextMenuVisible=!1},scrollInit(){const e=this.$refs.tags;function l(l){const t=l.wheelDelta||l.detail;let a=0;a=3==t||t<0&&-3!=t?50:-50,e.scrollLeft+=a}e.addEventListener("mousewheel",l,!1)||e.addEventListener("DOMMouseScroll",l,!1)}}},we={class:"adminui-tags"},Ie={ref:"tags"},Ve=["onContextmenu"],Te=u("hr",null,null,-1),Le=u("hr",null,null,-1);const Oe=E(xe,[["render",function(p,f,h,v,y,b){const k=e("el-icon-close"),x=e("el-icon"),w=e("router-link"),I=e("el-icon-refresh"),V=e("el-icon-folder-delete"),T=e("el-icon-full-screen"),L=e("el-icon-copy-document");return l(),t(i,null,[u("div",we,[u("ul",Ie,[(l(!0),t(i,null,o(y.tagList,(e=>(l(),t("li",{key:e,class:_([b.isActive(e)?"active":"",e.meta.affix?"affix":""]),onContextmenu:r((l=>b.openContextMenu(l,e)),["prevent"])},[a(w,{to:e},{default:c((()=>[u("span",null,d(e.meta.title),1),e.meta.affix?n("",!0):(l(),s(x,{key:0,onClick:r((l=>b.closeSelectedTag(e)),["prevent","stop"])},{default:c((()=>[a(k)])),_:2},1032,["onClick"]))])),_:2},1032,["to"])],42,Ve)))),128))],512)]),a(C,{name:"el-zoom-in-top"},{default:c((()=>[y.contextMenuVisible?(l(),t("ul",{key:0,style:m({left:y.left+"px",top:y.top+"px"}),class:"contextmenu",id:"contextmenu"},[u("li",{onClick:f[0]||(f[0]=e=>b.refreshTab())},[a(x,null,{default:c((()=>[a(I)])),_:1}),g("刷新 ")]),Te,u("li",{onClick:f[1]||(f[1]=e=>b.closeTabs()),class:_(y.contextMenuItem.meta.affix?"disabled":"")},[a(x,null,{default:c((()=>[a(k)])),_:1}),g("关闭标签 ")],2),u("li",{onClick:f[2]||(f[2]=e=>b.closeOtherTabs())},[a(x,null,{default:c((()=>[a(V)])),_:1}),g("关闭其他标签 ")]),Le,u("li",{onClick:f[3]||(f[3]=e=>b.maximize())},[a(x,null,{default:c((()=>[a(T)])),_:1}),g("最大化 ")]),u("li",{onClick:f[4]||(f[4]=e=>b.openWindow())},[a(x,null,{default:c((()=>[a(L)])),_:1}),g("在新的窗口中打开 ")])],4)):n("",!0)])),_:1})],64)}]]),Me={class:"sc-search"},Ne={key:0,class:"sc-search-history"},Ee={class:"sc-search-result"},je={key:0,class:"sc-search-no-result"},$e={key:1},Fe=["onClick"],Se={class:"title"};const Ue=E({data:()=>({input:"",menu:[],result:[],history:[]}),mounted(){var e=this.$TOOL.data.get("SEARCH_HISTORY")||[];this.history=e;var l=this.$TOOL.data.get("MENU");this.filterMenu(l),this.$refs.input.focus()},methods:{inputChange(e){this.result=e?this.menuFilter(e):[]},filterMenu(e){e.forEach((e=>{if(e.meta.hidden||"button"==e.meta.type)return!1;"iframe"==e.meta.type&&(e.path=`/i/${e.name}`),e.children&&e.children.length>0&&!e.component?this.filterMenu(e.children):this.menu.push(e)}))},menuFilter(e){var l=[],t=this.menu.filter((l=>l.meta.title.toLowerCase().indexOf(e.toLowerCase())>=0||(l.name.toLowerCase().indexOf(e.toLowerCase())>=0||void 0))),a=this.$router.getRoutes();return t.map((e=>"link"==e.meta.type?a.find((l=>l.path=="/"+e.path)):a.find((l=>l.path==e.path)))).forEach((e=>{l.push({name:e.name,type:e.meta.type,path:"link"==e.meta.type?e.path.slice(1):e.path,icon:e.meta.icon,title:e.meta.title,breadcrumb:e.meta.breadcrumb.map((e=>e.meta.title)).join(" - ")})})),l},to(e){this.history.includes(this.input)||(this.history.push(this.input),this.$TOOL.data.set("SEARCH_HISTORY",this.history)),"link"==e.type?setTimeout((()=>{let l=document.createElement("a");l.style="display: none",l.target="_blank",l.href=e.path,document.body.appendChild(l),l.click(),document.body.removeChild(l)}),10):this.$router.push({path:e.path}),this.$emit("success",!0)},historyClick(e){this.input=e,this.inputChange(e)},historyClose(e){this.history.splice(e,1),this.history.length<=0?this.$TOOL.data.remove("SEARCH_HISTORY"):this.$TOOL.data.set("SEARCH_HISTORY",this.history)}}},[["render",function(r,m,f,h,v,y){const b=e("el-input"),k=e("el-tag"),_=e("el-icon"),C=e("el-scrollbar");return l(),t("div",Me,[a(b,{ref:"input",modelValue:v.input,"onUpdate:modelValue":m[0]||(m[0]=e=>v.input=e),placeholder:"搜索",size:"large",clearable:"","prefix-icon":"el-icon-search","trigger-on-focus":!1,onInput:y.inputChange},null,8,["modelValue","onInput"]),v.history.length>0?(l(),t("div",Ne,[(l(!0),t(i,null,o(v.history,((e,t)=>(l(),s(k,{closable:"",effect:"dark",type:"info",key:e,onClick:l=>y.historyClick(e),onClose:e=>y.historyClose(t)},{default:c((()=>[g(d(e),1)])),_:2},1032,["onClick","onClose"])))),128))])):n("",!0),u("div",Ee,[v.result.length<=0?(l(),t("div",je,"暂无搜索结果")):(l(),t("ul",$e,[a(C,{"max-height":"366px"},{default:c((()=>[(l(!0),t(i,null,o(v.result,(e=>(l(),t("li",{key:e.path,onClick:l=>y.to(e)},[a(_,null,{default:c((()=>[(l(),s(p(e.icon||"el-icon-menu")))])),_:2},1024),u("span",Se,d(e.breadcrumb),1)],8,Fe)))),128))])),_:1})]))])])}],["__scopeId","data-v-d9b69c88"]]),Pe={data:()=>({loading:!1,tasks:[]}),mounted(){this.getData()},methods:{async getData(){this.loading=!0;var e=await this.$API.system.tasks.list.get();this.tasks=e.data,this.loading=!1},refresh(){this.getData()},download(e){let l=document.createElement("a");l.style="display: none",l.target="_blank",l.href=e.result,document.body.appendChild(l),l.click(),document.body.removeChild(l)}}},Ae=e=>(b("data-v-bfb4c253"),e=e(),k(),e),De=Ae((()=>u("h2",null,"没有正在执行的任务",-1))),ze=Ae((()=>u("p",{style:{"font-size":"14px",color:"#999","line-height":"1.5",margin:"0 40px"}},"在处理耗时过久的任务时为了不阻碍正在处理的工作，可在任务中心进行异步执行。",-1))),Re={class:"user-bar-tasks-item-body"},Ge={class:"taskIcon"},qe={class:"taskMain"},Be={class:"title"},He={class:"bottom"},Je={class:"state"},We={class:"handler"};const Ye=E(Pe,[["render",function(r,m,p,v,y,b){const k=e("el-empty"),_=e("el-icon-paperclip"),C=e("el-icon"),x=e("el-icon-dataAnalysis"),w=e("el-tag"),I=e("el-button"),V=e("el-card"),T=e("el-main"),L=e("el-footer"),O=e("el-container"),M=f("time"),N=f("loading");return h((l(),s(O,null,{default:c((()=>[a(T,null,{default:c((()=>[0==y.tasks.length?(l(),s(k,{key:0,"image-size":120},{description:c((()=>[De])),default:c((()=>[ze])),_:1})):n("",!0),(l(!0),t(i,null,o(y.tasks,(e=>(l(),s(V,{key:e.id,shadow:"hover",class:"user-bar-tasks-item"},{default:c((()=>[u("div",Re,[u("div",Ge,["export"==e.type?(l(),s(C,{key:0,size:20},{default:c((()=>[a(_)])),_:1})):n("",!0),"report"==e.type?(l(),s(C,{key:1,size:20},{default:c((()=>[a(x)])),_:1})):n("",!0)]),u("div",qe,[u("div",Be,[u("h2",null,d(e.taskName),1),u("p",null,[h(u("span",null,null,512),[[M,e.createDate,void 0,{tip:!0}]]),g(" 创建")])]),u("div",He,[u("div",Je,["0"==e.state?(l(),s(w,{key:0,type:"info"},{default:c((()=>[g("执行中")])),_:1})):n("",!0),"1"==e.state?(l(),s(w,{key:1},{default:c((()=>[g("完成")])),_:1})):n("",!0)]),u("div",We,["1"==e.state?(l(),s(I,{key:0,type:"primary",circle:"",icon:"el-icon-download",onClick:l=>b.download(e)},null,8,["onClick"])):n("",!0)])])])])])),_:2},1024)))),128))])),_:1}),a(L,{style:{padding:"10px","text-align":"right"}},{default:c((()=>[a(I,{circle:"",icon:"el-icon-refresh",onClick:b.refresh},null,8,["onClick"])])),_:1})])),_:1})),[[N,y.loading]])}],["__scopeId","data-v-bfb4c253"]]),Ke=[{name:"默认",icons:["el-icon-add-location","el-icon-aim","el-icon-alarm-clock","el-icon-apple","el-icon-arrow-down","el-icon-arrow-down-bold","el-icon-arrow-left","el-icon-arrow-left-bold","el-icon-arrow-right","el-icon-arrow-right-bold","el-icon-arrow-up","el-icon-arrow-up-bold","el-icon-avatar","el-icon-back","el-icon-baseball","el-icon-basketball","el-icon-bell","el-icon-bell-filled","el-icon-bicycle","el-icon-bottom","el-icon-bottom-left","el-icon-bottom-right","el-icon-bowl","el-icon-box","el-icon-briefcase","el-icon-brush","el-icon-brush-filled","el-icon-burger","el-icon-calendar","el-icon-camera","el-icon-camera-filled","el-icon-caret-bottom","el-icon-caret-left","el-icon-caret-right","el-icon-caret-top","el-icon-cellphone","el-icon-chat-dot-round","el-icon-chat-dot-square","el-icon-chat-line-round","el-icon-chat-line-square","el-icon-chat-round","el-icon-chat-square","el-icon-check","el-icon-checked","el-icon-cherry","el-icon-chicken","el-icon-circle-check","el-icon-circle-check-filled","el-icon-circle-close","el-icon-circle-close-filled","el-icon-circle-plus","el-icon-circle-plus-filled","el-icon-clock","el-icon-close","el-icon-close-bold","el-icon-cloudy","el-icon-coffee","el-icon-coffee-cup","el-icon-coin","el-icon-cold-drink","el-icon-collection","el-icon-collection-tag","el-icon-comment","el-icon-compass","el-icon-connection","el-icon-coordinate","el-icon-copy-document","el-icon-cpu","el-icon-credit-card","el-icon-crop","el-icon-d-arrow-left","el-icon-d-arrow-right","el-icon-d-caret","el-icon-data-analysis","el-icon-data-board","el-icon-data-line","el-icon-delete","el-icon-delete-filled","el-icon-delete-location","el-icon-dessert","el-icon-discount","el-icon-dish","el-icon-dish-dot","el-icon-document","el-icon-document-add","el-icon-document-checked","el-icon-document-copy","el-icon-document-delete","el-icon-document-remove","el-icon-download","el-icon-drizzling","el-icon-edit","el-icon-edit-pen","el-icon-eleme","el-icon-eleme-filled","el-icon-element-plus","el-icon-expand","el-icon-failed","el-icon-female","el-icon-files","el-icon-film","el-icon-filter","el-icon-finished","el-icon-first-aid-kit","el-icon-flag","el-icon-fold","el-icon-folder","el-icon-folder-add","el-icon-folder-checked","el-icon-folder-delete","el-icon-folder-opened","el-icon-folder-remove","el-icon-food","el-icon-football","el-icon-fork-spoon","el-icon-fries","el-icon-full-screen","el-icon-goblet","el-icon-goblet-full","el-icon-goblet-square","el-icon-goblet-square-full","el-icon-goods","el-icon-goods-filled","el-icon-grape","el-icon-grid","el-icon-guide","el-icon-headset","el-icon-help","el-icon-help-filled","el-icon-hide","el-icon-histogram","el-icon-home-filled","el-icon-hot-water","el-icon-house","el-icon-ice-cream","el-icon-ice-cream-round","el-icon-ice-cream-square","el-icon-ice-drink","el-icon-ice-tea","el-icon-info-filled","el-icon-iphone","el-icon-key","el-icon-knife-fork","el-icon-lightning","el-icon-link","el-icon-list","el-icon-loading","el-icon-location","el-icon-location-filled","el-icon-location-information","el-icon-lock","el-icon-lollipop","el-icon-magic-stick","el-icon-magnet","el-icon-male","el-icon-management","el-icon-map-location","el-icon-medal","el-icon-menu","el-icon-message","el-icon-message-box","el-icon-mic","el-icon-microphone","el-icon-milk-tea","el-icon-minus","el-icon-money","el-icon-monitor","el-icon-moon","el-icon-moon-night","el-icon-more","el-icon-more-filled","el-icon-mostly-cloudy","el-icon-mouse","el-icon-mug","el-icon-mute","el-icon-mute-notification","el-icon-no-smoking","el-icon-notebook","el-icon-notification","el-icon-odometer","el-icon-office-building","el-icon-open","el-icon-operation","el-icon-opportunity","el-icon-orange","el-icon-paperclip","el-icon-partly-cloudy","el-icon-pear","el-icon-phone","el-icon-phone-filled","el-icon-picture","el-icon-picture-filled","el-icon-picture-rounded","el-icon-pie-chart","el-icon-place","el-icon-platform","el-icon-plus","el-icon-pointer","el-icon-position","el-icon-postcard","el-icon-pouring","el-icon-present","el-icon-price-tag","el-icon-printer","el-icon-promotion","el-icon-question-filled","el-icon-rank","el-icon-reading","el-icon-reading-lamp","el-icon-refresh","el-icon-refresh-left","el-icon-refresh-right","el-icon-refrigerator","el-icon-remove","el-icon-remove-filled","el-icon-right","el-icon-scale-to-original","el-icon-school","el-icon-scissor","el-icon-search","el-icon-select","el-icon-sell","el-icon-semi-select","el-icon-service","el-icon-set-up","el-icon-setting","el-icon-share","el-icon-ship","el-icon-shop","el-icon-shopping-bag","el-icon-shopping-cart","el-icon-shopping-cart-full","el-icon-smoking","el-icon-soccer","el-icon-sold-out","el-icon-sort","el-icon-sort-down","el-icon-sort-up","el-icon-stamp","el-icon-star","el-icon-star-filled","el-icon-stopwatch","el-icon-success-filled","el-icon-sugar","el-icon-suitcase","el-icon-sunny","el-icon-sunrise","el-icon-sunset","el-icon-switch","el-icon-switch-button","el-icon-takeaway-box","el-icon-ticket","el-icon-tickets","el-icon-timer","el-icon-toilet-paper","el-icon-tools","el-icon-top","el-icon-top-left","el-icon-top-right","el-icon-trend-charts","el-icon-trophy","el-icon-turn-off","el-icon-umbrella","el-icon-unlock","el-icon-upload","el-icon-upload-filled","el-icon-user","el-icon-user-filled","el-icon-van","el-icon-video-camera","el-icon-video-camera-filled","el-icon-video-pause","el-icon-video-play","el-icon-view","el-icon-wallet","el-icon-wallet-filled","el-icon-warning","el-icon-warning-filled","el-icon-watch","el-icon-watermelon","el-icon-wind-power","el-icon-zoom-in","el-icon-zoom-out"]}],Xe={class:"mt-20"},Qe={class:"ml-icon-select__list"},Ze=["onClick"],el=["data-icon"],ll={class:"icon-name"},tl={class:"mt-10 footer-box"},al={class:"fl"},nl=(e=>(b("data-v-a98b7c1c"),e=e(),k(),e))((()=>u("span",{class:"ml-5"},"选择颜色",-1))),il=E({__name:"index",props:{modelValue:null,useIcon:{type:Object,default:()=>({name:"",color:""})}},emits:["update:modelValue","confirmIcon"],setup(r,{emit:m}){const f=r;let h=x(!1),v=x("");w((()=>f.modelValue),(()=>{h.value=f.modelValue,b.value={...f.useIcon}}),{deep:!0}),w((()=>h),(e=>{m("update:modelValue",e)}),{deep:!0}),w((()=>v),(e=>{k(e.value)}),{deep:!0});let y=x([]),b=x({name:"",color:""});I((()=>{h.value=f.modelValue,y.value=JSON.parse(JSON.stringify(Ke))}));const k=e=>{if(e){const l=JSON.parse(JSON.stringify(Ke));l.forEach((l=>{l.icons=l.icons.filter((l=>l.includes(e)))})),y.value=l}else y.value=JSON.parse(JSON.stringify(Ke))},C=e=>{let l=e.split("-");return l[l.length-1]},L=()=>{m("confirmIcon",b.value)};return(r,m)=>{const f=e("ElIconSearch"),k=e("el-icon"),x=e("el-input"),w=e("el-tag"),I=e("el-empty"),O=e("el-scrollbar"),M=e("el-tab-pane"),N=e("el-tabs"),E=e("el-color-picker"),j=e("el-button"),$=e("mlDialog");return l(),s($,{title:"图标选择器","append-to-body":"",width:"37%",modelValue:V(h),"onUpdate:modelValue":m[3]||(m[3]=e=>T(h)?h.value=e:h=e)},{default:c((()=>[a(x,{modelValue:V(v),"onUpdate:modelValue":m[0]||(m[0]=e=>T(v)?v.value=e:v=e),size:"large",placeholder:"搜索"},{prefix:c((()=>[a(k,{class:"el-input__seatch"},{default:c((()=>[a(f)])),_:1})])),_:1},8,["modelValue"]),u("div",Xe,[a(N,null,{default:c((()=>[(l(!0),t(i,null,o(V(y),(e=>(l(),s(M,{key:e.name,lazy:""},{label:c((()=>[g(d(e.name)+" ",1),a(w,{size:"small",type:"info"},{default:c((()=>[g(d(e.icons.length),1)])),_:2},1024)])),default:c((()=>[u("div",Qe,[a(O,null,{default:c((()=>[u("ul",null,[0==e.icons.length?(l(),s(I,{key:0,"image-size":100,description:"未查询到相关图标"})):n("",!0),(l(!0),t(i,null,o(e.icons,(e=>(l(),t("li",{key:e,onClick:l=>(e=>{b.value.name=e})(e),class:_({"is-active":V(b).name==e})},[u("span",{"data-icon":e},null,8,el),a(k,null,{default:c((()=>[(l(),s(p(e)))])),_:2},1024),u("span",ll,d(C(e)),1)],10,Ze)))),128))])])),_:2},1024)])])),_:2},1024)))),128))])),_:1})]),u("div",tl,[u("span",al,[a(E,{modelValue:V(b).color,"onUpdate:modelValue":m[1]||(m[1]=e=>V(b).color=e)},null,8,["modelValue"]),nl]),a(j,{style:{width:"80px"},onClick:m[2]||(m[2]=e=>T(h)?h.value=!1:h=!1)},{default:c((()=>[g("取消")])),_:1}),a(j,{type:"primary",style:{width:"80px"},onClick:L},{default:c((()=>[g("确认")])),_:1})])])),_:1},8,["modelValue"])}}},[["__scopeId","data-v-a98b7c1c"]]),ol={class:"clearfix"},sl={class:"sortable-box fl"},cl=["onClick"],ul={class:"mover fl"},dl={class:"fl item text-ellipsis"},rl={class:"action-icon"},ml=["onClick"],pl={key:0,class:"fl right-div"},fl={key:1,class:"fl right-div"},hl={key:0},vl={key:1},gl={key:2},yl={class:"mt-10"},bl={class:"mt-10"},kl={class:"footer-div"},_l=E({__name:"setTopMenu",props:{modelValue:null},emits:["update:modelValue"],setup(m,{emit:v}){const y=m,{getAllNav:b,getTopNavigation:k,getNavigationApi:C}=F(),M=B(),N=L("$ElMessage"),E=L("$API"),j=L("$TOOL");let $=x(!1),S=x(!1);w((()=>y.modelValue),(()=>{U()}),{deep:!0}),w((()=>$.value),(e=>{v("update:modelValue",e)}),{deep:!0}),I((()=>{U()}));const U=()=>{$.value=y.modelValue,$.value&&(document.body.ondrop=function(e){e.preventDefault(),e.stopPropagation()},Z())};let P=O({layoutConfigId:"",configName:"",list:[],shareTo:"ALL"}),A=x("父级菜单");let D=x(!1),z=x({});const R=({name:e,color:l})=>{H.value.useIcon=e,H.value.iconColor=l,D.value=!1},G=()=>{D.value=!0,z.value={name:H.value.useIcon,color:H.value.iconColor||""}};let q=O({configName:"未命名",type:1,layoutConfigId:null,outLink:"",guid:"",useIcon:"",iconColor:""});let H=x(null);const J=e=>{let l=b().filter((l=>l.layoutConfigId==e));H.value.configName=l[0].configName,H.value.layoutConfigId=l[0].layoutConfigId},Y=()=>{q.guid="xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,(function(e){var l=16*Math.random()|0;return("x"==e?l:3&l|8).toString(16)})),P.list.push(Object.assign({},q)),H.value=Object.assign({},q)},K=()=>{if(1==H.value.type&&!H.value.layoutConfigId)return void N.warning("请选择关联项");if(2==H.value.type&&!H.value.outLink)return void N.warning("请输入外部地址");let e=X(P.list,H.value.guid);-1==e?P.list.push(Object.assign({},H.value)):P.list[e]=Object.assign(P.list[e],H.value),H.value=null},X=(e,l)=>{for(let t=0;t<e.length;t++){if(e[t].guid==l)return t}return-1};let Q=O({});const Z=()=>{P=Object.assign(P,k()),Q=Object.assign({},k()),P.list=JSON.parse(JSON.stringify(P.navList)),H.value=null},ee=async()=>{let{layoutConfigId:e,list:l}=P,t={navList:l.filter((e=>e.layoutConfigId))};P.config=JSON.stringify(t);let a={};if(j.checkIsEdit(Q.config,P.config)&&(a.config=P.config),"{}"==JSON.stringify(a))return S.value=!1,void($.value=!1);S.value=!0;let n=await E.layoutConfig.saveConfig(e,"TOP_NAV",a);n&&n.data&&(C(),N.success("保存成功"),$.value=!1,M.go(0)),S.value=!1};return(m,v)=>{const y=e("ElIconRank"),k=e("el-icon"),C=e("SetUp"),x=e("ElIconCloseBold"),w=e("el-tab-pane"),I=e("el-tabs"),L=e("el-option"),O=e("el-select"),M=e("el-input"),N=e("el-button"),E=e("ElIconPlus"),j=e("mlDialog"),F=f("loading");return l(),t(i,null,[a(j,{title:"设置顶部导航菜单",modelValue:V($),"onUpdate:modelValue":v[6]||(v[6]=e=>T($)?$.value=e:$=e),width:"680px"},{footer:c((()=>[u("div",kl,[a(N,{onClick:v[5]||(v[5]=e=>T($)?$.value=!1:$=!1),loading:V(S)},{default:c((()=>[g("取消")])),_:1},8,["loading"]),a(N,{type:"primary",onClick:ee,loading:V(S)},{default:c((()=>[g("保存")])),_:1},8,["loading"])])])),default:c((()=>[h((l(),t("div",null,[u("div",ol,[u("div",sl,[a(V(W),{"ghost-class":"ghost","chosen-class":"chosenClass",animation:"300","force-fallback":!1,handle:".mover",list:V(P).list},{default:c((()=>[(l(!0),t(i,null,o(V(P).list,((e,n)=>{var i;return l(),t("div",{class:"parent-li",key:n},[u("div",{class:_(["paren-idv",{"is-active":(null==(i=V(H))?void 0:i.guid)==e.guid}]),onClick:l=>{return t=e,H.value=Object.assign({},t),void(H.value.useIcon=H.value.useIcon||"");var t}},[u("div",ul,[a(k,{size:"20",class:"icon"},{default:c((()=>[a(y)])),_:1})]),u("div",dl,[e.useIcon?(l(),s(k,{key:1,class:"icon",color:e.iconColor},{default:c((()=>[(l(),s(p(e.useIcon)))])),_:2},1032,["color"])):(l(),s(k,{key:0,class:"icon"},{default:c((()=>[a(C)])),_:1})),g(" "+d(e.configName),1)]),u("div",rl,[u("span",{class:"icon-span",onClick:r((l=>((e,l,t)=>{e.parentGuid?P.list[l].children.splice(t,1):P.list.splice(l,1),H.value&&H.value.guid&&e.guid==H.value.guid&&(H.value=null)})(e,n)),["stop"])},[a(k,{size:"16"},{default:c((()=>[a(x)])),_:1})],8,ml)])],10,cl)])})),128))])),_:1},8,["list"])]),V(H)?(l(),t("div",fl,[a(I,{modelValue:V(H).type,"onUpdate:modelValue":v[0]||(v[0]=e=>V(H).type=e)},{default:c((()=>[a(w,{label:"关联项",name:1}),a(w,{label:"外部地址",name:2})])),_:1},8,["modelValue"]),1!=V(H).type&&4!=V(H).type||V(H).children&&!(V(H).children&&V(H).children.length<1)||"parentMenu"==V(H).entityCode?n("",!0):(l(),t("div",hl,[a(O,{modelValue:V(H).layoutConfigId,"onUpdate:modelValue":v[1]||(v[1]=e=>V(H).layoutConfigId=e),filterable:"",placeholder:"选择关联项",class:"w-100",onChange:J},{default:c((()=>[(l(!0),t(i,null,o(V(b)(),((e,t)=>(l(),s(L,{key:t,value:e.layoutConfigId,label:e.configName},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])])),1!=V(H).type&&4!=V(H).type||!(V(H).children&&V(H).children.length>0||"parentMenu"==V(H).entityCode)?n("",!0):(l(),t("div",vl,[a(O,{modelValue:V(A),"onUpdate:modelValue":v[2]||(v[2]=e=>T(A)?A.value=e:A=e),filterable:"",class:"w-100",disabled:""},null,8,["modelValue"])])),2==V(H).type?(l(),t("div",gl,[a(M,{modelValue:V(H).outLink,"onUpdate:modelValue":v[3]||(v[3]=e=>V(H).outLink=e),placeholder:"输入外部地址，例：https://www.baidu.com/",clearable:""},null,8,["modelValue"])])):n("",!0),u("div",yl,[a(M,{modelValue:V(H).configName,"onUpdate:modelValue":v[4]||(v[4]=e=>V(H).configName=e),placeholder:"菜单名称",class:"ml-el-select-input",clearable:""},{prepend:c((()=>[u("span",{class:"select-icon-span",title:"选择图标",onClick:G},[V(H).useIcon?(l(),s(k,{key:1,class:"icon",color:V(H).iconColor},{default:c((()=>[(l(),s(p(V(H).useIcon)))])),_:1},8,["color"])):(l(),s(k,{key:0,class:"icon"},{default:c((()=>[a(C)])),_:1}))])])),_:1},8,["modelValue"])]),u("div",bl,[a(N,{onClick:K},{default:c((()=>[g("确定")])),_:1})])])):(l(),t("div",pl,"点击左侧导航项进行编辑"))]),u("div",null,[a(N,{onClick:Y},{default:c((()=>[a(k,null,{default:c((()=>[a(E)])),_:1}),g("添加菜单项 ")])),_:1})])])),[[F,V(S)]])])),_:1},8,["modelValue"]),a(il,{modelValue:V(D),"onUpdate:modelValue":v[7]||(v[7]=e=>T(D)?D.value=e:D=e),useIcon:V(z),onConfirmIcon:R},null,8,["modelValue","useIcon"])],64)}}},[["__scopeId","data-v-3b0f3dc9"]]),Cl={class:"user-bar"},xl={class:"approval-center panel-item"},wl={class:"approval-icon-span"},Il={class:"msg-list"},Vl=["onClick"],Tl=["href"],Ll={class:"msg-list__icon"},Ol={class:"msg-list__main"},Ml={class:"msg-list__time"},Nl={class:"user-avatar"},El={key:0},jl=E({__name:"userbar",setup(r){const{newMsgNum:m}=D(S()),{setNewMsgNum:p}=S(),{unSystemEntityList:v}=D(j()),y=L("$TOOL"),b=L("$ElMessage");L("COMMON_CONFIG");const k=B();let _=x(""),C=x(""),w=x(""),O=x(!1),M=x(!1),N=x(!1),E=x([]),$=x(!1),F=x(!1);I((()=>{var e=y.data.get("USER_INFO");e?(_.value=e.userName,C.value=e.userId,w.value=_.value.substring(0,1)):k.push({path:"/web/login"})}));const A=e=>{"uc"==e&&k.push({path:"/web/usercenter"}),"cmd"==e&&k.push({path:"/web/cmd"}),"clearCache"==e&&Y.confirm("清除缓存会将系统初始化，包括登录状态、主题、通用设置等，是否继续？","提示",{type:"info"}).then((async()=>{if(await P.post("/user/logout")){k.replace({path:"/web/login"});const e=K.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"});y.data.clear(),y.cookie.remove("userInfo"),k.replace({path:"/web/login"}),setTimeout((()=>{e.close(),location.reload()}),1e3)}})).catch((()=>{})),"outLogin"==e&&Y.confirm("确认是否退出当前用户？","提示",{type:"warning",confirmButtonText:"退出",confirmButtonClass:"el-button--danger"}).then((async()=>{await P.post("/user/logout")&&k.replace({path:"/web/login"})})).catch((()=>{}))},z=e=>{k.push({name:e})},R=()=>{window.location.reload()},G=()=>{var e=document.documentElement;y.screen(e)},q=()=>{N.value=!0,W()},W=async()=>{$.value=!0;let e=await P.get("/note/query?unread=true");e&&(E.value=e.data||[],p(E.value.length)),$.value=!1};let X=x(""),Q=x(!1),Z=x(""),ee=x(""),le=x("");const te=(e,l)=>{E.value.splice(l,1),p(E.value.length),P.post("/note/read?id="+e.notificationId)},ae=()=>{P.post("/note/readAll"),E.value=[],p(0)};function ne(){let{currentRoute:e}=k;"Notification"!=e.value.name&&k.push("/web/notification"),N.value=!1}return(r,p)=>{const x=e("ElIconGrid"),w=e("el-icon"),I=e("el-tooltip"),L=e("el-icon-connection"),j=e("el-dropdown-item"),S=e("el-dropdown-menu"),P=e("el-dropdown"),D=e("ElIconRefresh"),B=e("el-icon-full-screen"),W=e("el-icon-chat-dot-round"),Y=e("el-badge"),K=e("mlAvatar"),ie=e("el-avatar"),oe=e("el-empty"),se=e("el-scrollbar"),ce=e("el-main"),ue=e("el-button"),de=e("el-footer"),re=e("el-container"),me=e("el-drawer"),pe=e("el-icon-arrow-down"),fe=e("el-dialog"),he=f("loading");return l(),t(i,null,[u("div",Cl,[V(y).checkRole("r6007")?(l(),s(I,{key:0,class:"box-item",effect:"light",content:"顶部导航设置",placement:"bottom"},{default:c((()=>[u("div",{class:"screen panel-item hidden-sm-and-down",onClick:p[0]||(p[0]=e=>T(F)?F.value=!0:F=!0)},[a(w,null,{default:c((()=>[a(x)])),_:1})])])),_:1})):n("",!0),a(I,{class:"box-item",effect:"light",content:"审批中心",placement:"bottom"},{default:c((()=>[u("div",xl,[a(P,{trigger:"click",onCommand:z},{dropdown:c((()=>[a(S,null,{default:c((()=>[a(j,{command:"CenterHandle"},{default:c((()=>[g("待我处理")])),_:1}),a(j,{command:"CenterSubmit"},{default:c((()=>[g("我提交的")])),_:1}),a(j,{command:"CenterCc"},{default:c((()=>[g("抄送我的")])),_:1})])),_:1})])),default:c((()=>[u("span",wl,[a(w,null,{default:c((()=>[a(L)])),_:1})])])),_:1})])])),_:1}),a(I,{class:"box-item",effect:"light",content:"刷新",placement:"bottom"},{default:c((()=>[u("div",{class:"screen panel-item hidden-sm-and-down",onClick:R},[a(w,null,{default:c((()=>[a(D)])),_:1})])])),_:1}),a(I,{class:"box-item",effect:"light",content:"全屏",placement:"bottom"},{default:c((()=>[u("div",{class:"screen panel-item hidden-sm-and-down",onClick:G},[a(w,null,{default:c((()=>[a(B)])),_:1})])])),_:1}),a(I,{class:"box-item",effect:"light",content:"消息",placement:"bottom"},{default:c((()=>[u("div",{class:"msg panel-item",onClick:q},[a(Y,{hidden:0==V(m),value:V(m),class:"badge",type:"danger"},{default:c((()=>[a(w,null,{default:c((()=>[a(W)])),_:1})])),_:1},8,["hidden","value"]),a(me,{title:"新消息",modelValue:V(N),"onUpdate:modelValue":p[1]||(p[1]=e=>T(N)?N.value=e:N=e),size:400,"append-to-body":"","destroy-on-close":""},{default:c((()=>[h((l(),s(re,null,{default:c((()=>[a(ce,{class:"nopadding"},{default:c((()=>[a(se,null,{default:c((()=>[u("ul",Il,[(l(!0),t(i,null,o(V(E),((e,n)=>(l(),t("li",{key:e.id,onClick:l=>((e,l)=>{let t=v.value.filter((l=>l.name==e.entityName));if(30==e.type||20==e.type)t.length<1?b.error("该实体已删除"):(N.value=!1,X.value.openDialog(e.relatedRecord.id));else if(10==e.type)Q.value=!0,Z.value=e.relatedRecord.id,ee.value=e.relatedRecord.id,le.value=e.relatedRecord.name;else{let{currentRoute:e}=k;"CenterCc"!=e.value.name&&k.push("/web/center-cc"),N.value=!1}e.unread&&te(e,l)})(e,n)},[u("a",{href:e.link,target:"_blank"},[u("div",Ll,[a(Y,{"is-dot":"",type:"danger"},{default:c((()=>[a(ie,{size:40},{default:c((()=>[a(K,{userId:e.fromUser.id},null,8,["userId"])])),_:2},1024)])),_:2},1024)]),u("div",Ol,[u("h2",null,d(e.fromUser.name),1),u("p",null,d(e.message),1)]),u("div",Ml,[u("p",null,d(V(U)(e.createdOn)),1)])],8,Tl)],8,Vl)))),128)),0==V(E).length?(l(),s(oe,{key:0,description:"暂无新消息","image-size":100})):n("",!0)])])),_:1})])),_:1}),a(de,null,{default:c((()=>[a(ue,{type:"primary",onClick:ne},{default:c((()=>[g("消息中心")])),_:1}),a(ue,{onClick:ae},{default:c((()=>[g("全部设为已读")])),_:1})])),_:1})])),_:1})),[[he,V($)]])])),_:1},8,["modelValue"])])])),_:1}),a(P,{class:"user panel-item",trigger:"click",onCommand:A},{dropdown:c((()=>[a(S,null,{default:c((()=>[a(j,{command:"uc"},{default:c((()=>[g("帐号信息")])),_:1}),a(j,{command:"clearCache"},{default:c((()=>[g("清除缓存")])),_:1}),a(j,{divided:"",command:"outLogin"},{default:c((()=>[g("退出登录")])),_:1})])),_:1})])),default:c((()=>[u("div",Nl,[a(ie,{size:30},{default:c((()=>[a(K,{userId:V(C)},null,8,["userId"])])),_:1}),u("label",null,d(V(_)),1),a(w,{class:"el-icon--right"},{default:c((()=>[a(pe)])),_:1})])])),_:1})]),a(fe,{modelValue:V(O),"onUpdate:modelValue":p[3]||(p[3]=e=>T(O)?O.value=e:O=e),width:700,title:"搜索",center:"","destroy-on-close":""},{default:c((()=>[a(Ue,{onSuccess:p[2]||(p[2]=e=>T(O)?O.value=!1:O=!1)})])),_:1},8,["modelValue"]),a(me,{modelValue:V(M),"onUpdate:modelValue":p[4]||(p[4]=e=>T(M)?M.value=e:M=e),size:450,title:"任务中心","destroy-on-close":""},{default:c((()=>[a(Ye)])),_:1},8,["modelValue"]),a(H,{ref_key:"detailRefs",ref:X},null,512),V(Q)?(l(),t("div",El,[a(J,{modelValue:V(Q),"onUpdate:modelValue":p[5]||(p[5]=e=>T(Q)?Q.value=e:Q=e),taskId:V(Z),entityId:V(ee),approvalName:V(le),title:"审批"},null,8,["modelValue","taskId","entityId","approvalName"])])):n("",!0),a(_l,{modelValue:V(F),"onUpdate:modelValue":p[6]||(p[6]=e=>T(F)?F.value=e:F=e)},null,8,["modelValue"])],64)}}},[["__scopeId","data-v-4175c359"]]),$l=z("globalStore",(()=>{let e=x(!1),l=x(A.LAYOUT),t=x(A.MENU_IS_COLLAPSE),a=x(A.LAYOUT_TAGS),n=x(A.THEME);return{ismobile:e,layout:l,menuIsCollapse:t,layoutTags:a,theme:n,SET_ismobile:function(l){e.value=l},SET_layout:function(e){l.value=e},SET_theme:function(e){n.value=e},TOGGLE_menuIsCollapse:function(){t.value=!t.value},TOGGLE_layoutTags:function(){a.value=!a.value}}}),{persist:!0}),{layout:Fl,menuIsCollapse:Sl,layoutTags:Ul}=D($l()),{SET_layout:Pl}=$l();const Al=E({data(){return{layout:Fl.value,menuIsCollapse:Sl.value,layoutTags:Ul.value,lang:this.$TOOL.data.get("APP_LANG")||this.$CONFIG.LANG,dark:this.$TOOL.data.get("APP_DARK")||!1,colorList:["#409EFF","#009688","#536dfe","#ff5c93","#c62f2f","#fd726d"]}},watch:{layout(e){Pl(e)},menuIsCollapse(){TOGGLE_menuIsCollapse()},layoutTags(){TOGGLE_layoutTags()},dark(e){e?(document.documentElement.classList.add("dark"),this.$TOOL.data.set("APP_DARK",e)):(document.documentElement.classList.remove("dark"),this.$TOOL.data.remove("APP_DARK"))},lang(e){this.$i18n.locale=e,this.$TOOL.data.set("APP_LANG",e)}}},[["render",function(t,n,i,o,u,d){const r=e("el-alert"),m=e("el-divider"),p=e("el-switch"),f=e("el-form-item"),h=e("el-option"),v=e("el-select"),g=e("el-form");return l(),s(g,{ref:"form","label-width":"120px","label-position":"left",style:{padding:"0 20px"}},{default:c((()=>[a(r,{title:"以下配置可实时预览，开发者可在 config/index.js 中配置默认值，非常不建议在生产环境下开放布局设置",type:"error",closable:!1}),a(m),a(f,{label:t.$t("user.nightmode")},{default:c((()=>[a(p,{modelValue:u.dark,"onUpdate:modelValue":n[0]||(n[0]=e=>u.dark=e)},null,8,["modelValue"])])),_:1},8,["label"]),a(f,{label:t.$t("user.language")},{default:c((()=>[a(v,{modelValue:u.lang,"onUpdate:modelValue":n[1]||(n[1]=e=>u.lang=e)},{default:c((()=>[a(h,{label:"简体中文",value:"zh-cn"}),a(h,{label:"English",value:"en"})])),_:1},8,["modelValue"])])),_:1},8,["label"]),a(m),a(m),a(f,{label:"框架布局"},{default:c((()=>[a(v,{modelValue:u.layout,"onUpdate:modelValue":n[2]||(n[2]=e=>u.layout=e),placeholder:"请选择"},{default:c((()=>[a(h,{label:"默认",value:"default"}),a(h,{label:"通栏",value:"header"}),a(h,{label:"经典",value:"menu"}),a(h,{label:"功能坞",value:"dock"})])),_:1},8,["modelValue"])])),_:1}),a(f,{label:"折叠菜单"},{default:c((()=>[a(p,{modelValue:u.menuIsCollapse,"onUpdate:modelValue":n[3]||(n[3]=e=>u.menuIsCollapse=e)},null,8,["modelValue"])])),_:1}),a(f,{label:"标签栏"},{default:c((()=>[a(p,{modelValue:u.layoutTags,"onUpdate:modelValue":n[4]||(n[4]=e=>u.layoutTags=e)},null,8,["modelValue"])])),_:1}),a(m)])),_:1},512)}]]),Dl=q(),{iframeList:zl}=D(q()),{setIframeList:Rl,pushIframeList:Gl,clearIframeList:ql}=Dl,{ismobile:Bl,layoutTags:Hl}=D($l()),Jl={class:"iframe-pages"},Wl=["src"];const Yl=E({data:()=>({}),watch:{$route(e){this.push(e)}},data:()=>({ismobile:Bl.value,layoutTags:Hl.value}),created(){this.push(this.$route)},computed:{iframeList:()=>zl.value,ismobileFn:()=>Bl.value,layoutTagsFn:()=>Hl.value},mounted(){},methods:{push(e){"iframe"==e.meta.type?this.ismobileFn||!this.layoutTagsFn?Rl(e):Gl(e):!this.ismobileFn&&this.layoutTagsFn||ql()}}},[["render",function(e,a,n,s,c,u){return h((l(),t("div",Jl,[(l(!0),t(i,null,o(u.iframeList,(a=>h((l(),t("iframe",{key:a.meta.url,src:a.meta.url,frameborder:"0"},null,8,Wl)),[[M,e.$route.meta.url==a.meta.url]]))),128))],512)),[[M,"iframe"==e.$route.meta.type]])}],["__scopeId","data-v-79c5b440"]]),Kl={render(){},data(){return{logoutCount:this.$TOOL.data.get("AUTO_EXIT")}},mounted(){this.logoutCount&&(this.setNewAutoExitTime(),document.onclick=()=>{this.setNewAutoExitTime()},document.onmousemove=()=>{this.setNewAutoExitTime()},document.onkeydown=()=>{this.setNewAutoExitTime()},document.onscroll=()=>{this.setNewAutoExitTime()},window.autoExitTimer=window.setInterval(this.autoExitfun,1e3))},unmounted(){this.logoutCount&&(clearInterval(window.autoExitTimer),window.autoExitTimer=null)},methods:{setNewAutoExitTime(){window.autoExitTime=(new Date).getTime()},autoExitfun(){(new Date).getTime()-window.autoExitTime>60*this.logoutCount*1e3&&(clearInterval(window.autoExitTimer),window.autoExitTimer=null,this.$router.replace({path:"/web/login"}),this.$alert("用户长时间无操作，为保证账户安全，系统已自动登出。","提示",{type:"warning",center:!0,roundButton:!0}))}}},Xl={class:"clearfix"},Ql={class:"sortable-box fl"},Zl=["onClick"],et={class:"mover fl"},lt={class:"fl item text-ellipsis"},tt={class:"action-icon"},at=["onClick"],nt=["onClick"],it=["onClick"],ot={class:"submover fl"},st={class:"fl item text-ellipsis"},ct={class:"action-icon"},ut=["onClick"],dt={key:0,class:"fl right-div"},rt={key:1,class:"fl right-div"},mt={key:0},pt={key:1},ft={key:2},ht={key:3},vt={class:"mt-10"},gt={key:4,class:"mt-5"},yt={class:"mt-10"},bt={class:"footer-div"},kt={class:"share-to fl"},_t=E({__name:"setMenu",props:{modelValue:null,menuInfo:{type:Object,default:()=>{}}},emits:["update:modelValue"],setup(m,{emit:v}){const y=m,b=B(),k=L("$ElMessage"),C=L("$API"),M=L("$TOOL"),{unSystemEntityList:N}=D(j()),{getNavigationApi:E}=F(),{chosenNavigationId:$}=D(F());let S=x(!1),U=x(!1),P=O({layoutConfigId:"",configName:"",list:[],shareTo:"ALL"});w((()=>S.value),(e=>{v("update:modelValue",e)}),{deep:!0}),I((()=>{S.value=y.modelValue,document.body.ondrop=function(e){e.preventDefault(),e.stopPropagation()},se()}));let A=x("父级菜单");const z=()=>{let e=[{label:"部门用户",entityCode:22,name:"Department"},{label:"权限角色",entityCode:23,name:"Role"},{label:"团队",entityCode:24,name:"Team"}];return Q.value.parentGuid||(e=[...e,{label:"父级菜单",entityCode:"parentMenu",name:"parentMenu"}]),[{label:"自定义实体",options:[...N.value.filter((e=>!e.detailEntityFlag))]},{label:"系统内置",options:[...e]},{label:"审批流程",options:[{label:"待我处理",name:"approvalHandle",entityCode:"approvalHandle"},{label:"我提交的",name:"approvalSubmit",entityCode:"approvalSubmit"},{label:"抄送我的",name:"capprovalCc",entityCode:"capprovalCc"}]}]},R=e=>{Q.value=Object.assign({},e),Q.value.useIcon=Q.value.useIcon||""};let G=x(!1),q=x({});const H=({name:e,color:l})=>{Q.value.useIcon=e,Q.value.iconColor=l,G.value=!1},J=()=>{G.value=!0,q.value={name:Q.value.useIcon,color:Q.value.iconColor||""}};let Y=O({name:"未命名",type:1,entityCode:null,outLink:"",guid:"",parentGuid:"",isOpeneds:!1,useIcon:"",iconColor:""});const K=()=>"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,(function(e){var l=16*Math.random()|0;return("x"==e?l:3&l|8).toString(16)}));let Q=x(null);const Z=e=>{let l;for(let t=0;t<z().length;t++){const a=z()[t];for(let t=0;t<a.options.length;t++){const n=a.options[t];n.entityCode!=e||(l=n)}}Q.value.name=l.label,Q.value.entityCode=l.entityCode,Q.value.entityName=l.name},ee=()=>{Y.guid=K(),P.list.push(Object.assign({},Y)),Q.value=Object.assign({},Y)},le=x(["Department","Role","Team","approvalHandle","approvalSubmit","capprovalCc"]),te=O({Department:"entity-user",Role:"entity-role",Team:"entity-team",approvalHandle:"approval-handle",approvalSubmit:"approval-submit",capprovalCc:"approval-cc"}),ae=()=>{if(1!=Q.value.type||Q.value.entityCode||Q.value.children&&!(Q.value.children.length<1))if(2!=Q.value.type||Q.value.outLink)if(3!=Q.value.type||Q.value.outLink){if(le.value.includes(Q.value.entityName)&&(Q.value.type=4,Q.value.outLink=te[Q.value.entityName]),Q.value.parentGuid){let e=ne(P.list,Q.value.parentGuid);if(-1==e)Q.value.parentGuid="",P.list.push(Object.assign({},Q.value));else{let l=ne(P.list[e].children,Q.value.guid);-1==l?P.list[e].children.push(Object.assign({},Q.value)):P.list[e].children[l]=Object.assign({},Q.value)}}else{let e=ne(P.list,Q.value.guid);-1==e?P.list.push(Object.assign({},Q.value)):P.list[e]=Object.assign(P.list[e],Q.value)}Q.value=null}else k.warning("请输入自定义页面名称");else k.warning("请输入外部地址");else k.warning("请选择关联项")},ne=(e,l)=>{for(let t=0;t<e.length;t++){if(e[t].guid==l)return t}return-1},ie=(e,l,t)=>{e.parentGuid?P.list[l].children.splice(t,1):P.list.splice(l,1),Q.value&&Q.value.guid&&e.guid==Q.value.guid&&(Q.value=null)};let oe=O({});const se=()=>{P=Object.assign(P,y.menuInfo),oe=Object.assign({},y.menuInfo),P.list=P.config?JSON.parse(P.config):[]},ce=async()=>{let{layoutConfigId:e,configName:l}=P;if(!l)return void k.warning("请输入菜单名称");let t=[...ue()];if(t.length<1)return void k.warning("请至少添加一个菜单项");t.forEach((e=>{e.children&&e.children.length>0&&(e.entityCode="parentMenu",e.entityName="parentMenu")})),P.config=JSON.stringify(t);let a={};if(M.checkIsEdit(oe.configName,P.configName)&&(a.configName=P.configName),M.checkIsEdit(oe.config,P.config)&&(a.config=P.config),M.checkIsEdit(oe.shareTo,P.shareTo)&&(a.shareTo=P.shareTo),"{}"==JSON.stringify(a))return k.success("保存成功"),U.value=!1,void(S.value=!1);U.value=!0,await C.layoutConfig.saveConfig(e,"NAV",a)&&($.value&&$.value==P.layoutConfigId&&M.checkIsEdit(oe.config,P.config)?b.go(0):(E(),S.value=!1)),U.value=!1},ue=()=>{let e=[];return P.list.forEach((l=>{if(l.entityCode||l.outLink||l.children&&l.children.length>0){let t={...l};l.children&&l.children.length>0&&(t.children=[],l.children.forEach((e=>{(e.entityCode||e.outLink)&&t.children.push(e)}))),e.push(t)}})),e.forEach(((l,t)=>{"parentMenu"==l.entityCode&&(!l.children||l.children.length<1)&&e.splice(t,1),!l.entityCode&&!l.outLink&&l.children.length<1&&e.splice(t,1)})),e};return(m,v)=>{const y=e("el-input"),b=e("el-form-item"),k=e("el-form"),C=e("ElIconRank"),x=e("el-icon"),w=e("SetUp"),I=e("ElIconCloseBold"),L=e("el-tab-pane"),O=e("el-tabs"),M=e("el-option"),N=e("el-option-group"),E=e("el-select"),j=e("el-checkbox"),$=e("el-button"),F=e("ElIconPlus"),D=e("mlDialog"),B=f("loading");return l(),t(i,null,[a(D,{title:"设置导航菜单",modelValue:V(S),"onUpdate:modelValue":v[11]||(v[11]=e=>T(S)?S.value=e:S=e),width:"680px"},{footer:c((()=>[u("div",bt,[u("div",kt,[a(X,{modelValue:V(P).shareTo,"onUpdate:modelValue":v[9]||(v[9]=e=>V(P).shareTo=e)},null,8,["modelValue"])]),a($,{onClick:v[10]||(v[10]=e=>T(S)?S.value=!1:S=!1),loading:V(U)},{default:c((()=>[g("取消")])),_:1},8,["loading"]),a($,{type:"primary",onClick:ce,loading:V(U)},{default:c((()=>[g("保存")])),_:1},8,["loading"])])])),default:c((()=>[h((l(),t("div",null,[a(k,{"label-width":"70px","label-position":"left",onSubmit:v[1]||(v[1]=r((()=>{}),["prevent"]))},{default:c((()=>[a(b,{label:"导航名称"},{default:c((()=>[a(y,{modelValue:V(P).configName,"onUpdate:modelValue":v[0]||(v[0]=e=>V(P).configName=e),placeholder:"输入导航名称",clearable:""},null,8,["modelValue"])])),_:1})])),_:1}),u("div",Xl,[u("div",Ql,[a(V(W),{"ghost-class":"ghost","chosen-class":"chosenClass",animation:"300","force-fallback":!1,handle:".mover",list:V(P).list},{default:c((()=>[(l(!0),t(i,null,o(V(P).list,((e,n)=>{var m;return l(),t("div",{class:"parent-li",key:n},[u("div",{class:_(["paren-idv",{"is-active":(null==(m=V(Q))?void 0:m.guid)==e.guid}]),onClick:l=>R(e)},[u("div",et,[a(x,{size:"20",class:"icon"},{default:c((()=>[a(C)])),_:1})]),u("div",lt,[e.useIcon?(l(),s(x,{key:1,class:"icon",color:e.iconColor},{default:c((()=>[(l(),s(p(e.useIcon)))])),_:2},1032,["color"])):(l(),s(x,{key:0,class:"icon"},{default:c((()=>[a(w)])),_:1})),g(" "+d(e.name),1)]),u("div",tt,[u("span",{class:"icon-span add-icon mr-5",onClick:r((l=>(e=>{e.children||(e.children=[]);let l=Object.assign({},Y);l.parentGuid=e.guid,l.guid=K(),e.children.push(l),Q.value=Object.assign({},l)})(e)),["stop"])},[a(x,{size:"16"},{default:c((()=>[a(I)])),_:1})],8,at),u("span",{class:"icon-span",onClick:r((l=>ie(e,n)),["stop"])},[a(x,{size:"16"},{default:c((()=>[a(I)])),_:1})],8,nt)])],10,Zl),a(V(W),{"ghost-class":"subghost","chosen-class":"subchosenClass",animation:"300","force-fallback":!1,handle:".submover",list:e.children},{default:c((()=>[(l(!0),t(i,null,o(e.children,((e,i)=>{var o;return l(),t("div",{class:_(["child-div",{"is-active":(null==(o=V(Q))?void 0:o.guid)==e.guid}]),key:i,onClick:l=>R(e)},[u("div",ot,[a(x,{size:"20",class:"icon"},{default:c((()=>[a(C)])),_:1})]),u("div",st,[e.useIcon?(l(),s(x,{key:1,class:"icon"},{default:c((()=>[(l(),s(p(e.useIcon)))])),_:2},1024)):(l(),s(x,{key:0,class:"icon"},{default:c((()=>[a(w)])),_:1})),g(" "+d(e.name),1)]),u("div",ct,[u("span",{class:"icon-span",onClick:r((l=>ie(e,n,i)),["stop"])},[a(x,{size:"16"},{default:c((()=>[a(I)])),_:1})],8,ut)])],10,it)})),128))])),_:2},1032,["list"])])})),128))])),_:1},8,["list"])]),V(Q)?(l(),t("div",rt,[a(O,{modelValue:V(Q).type,"onUpdate:modelValue":v[2]||(v[2]=e=>V(Q).type=e)},{default:c((()=>[a(L,{label:"关联项",name:1}),a(L,{label:"外部地址",name:2}),a(L,{label:"自定义页面",name:3})])),_:1},8,["modelValue"]),1!=V(Q).type&&4!=V(Q).type||V(Q).children&&!(V(Q).children&&V(Q).children.length<1)||"parentMenu"==V(Q).entityCode?n("",!0):(l(),t("div",mt,[a(E,{modelValue:V(Q).entityCode,"onUpdate:modelValue":v[3]||(v[3]=e=>V(Q).entityCode=e),filterable:"",placeholder:"选择关联项",class:"w-100",onChange:Z},{default:c((()=>[(l(!0),t(i,null,o(z(),(e=>(l(),s(N,{key:e.label,label:e.label},{default:c((()=>[(l(!0),t(i,null,o(e.options,((e,t)=>(l(),s(M,{key:t,value:e.entityCode,label:e.label},null,8,["value","label"])))),128))])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue"])])),1!=V(Q).type&&4!=V(Q).type||!(V(Q).children&&V(Q).children.length>0||"parentMenu"==V(Q).entityCode)?n("",!0):(l(),t("div",pt,[a(E,{modelValue:V(A),"onUpdate:modelValue":v[4]||(v[4]=e=>T(A)?A.value=e:A=e),filterable:"",class:"w-100",disabled:""},null,8,["modelValue"])])),3==V(Q).type?(l(),t("div",ft,[a(y,{modelValue:V(Q).outLink,"onUpdate:modelValue":v[5]||(v[5]=e=>V(Q).outLink=e),placeholder:"输入自定义页面名称，例：page",clearable:""},null,8,["modelValue"])])):n("",!0),2==V(Q).type?(l(),t("div",ht,[a(y,{modelValue:V(Q).outLink,"onUpdate:modelValue":v[6]||(v[6]=e=>V(Q).outLink=e),placeholder:"输入外部地址，例：https://www.baidu.com/",clearable:""},null,8,["modelValue"])])):n("",!0),u("div",vt,[a(y,{modelValue:V(Q).name,"onUpdate:modelValue":v[7]||(v[7]=e=>V(Q).name=e),placeholder:"菜单名称",class:"ml-el-select-input",clearable:""},{prepend:c((()=>[u("span",{class:"select-icon-span",title:"选择图标",onClick:J},[V(Q).useIcon?(l(),s(x,{key:1,class:"icon",color:V(Q).iconColor},{default:c((()=>[(l(),s(p(V(Q).useIcon)))])),_:1},8,["color"])):(l(),s(x,{key:0,class:"icon"},{default:c((()=>[a(w)])),_:1}))])])),_:1},8,["modelValue"])]),V(Q).children&&V(Q).children.length>0?(l(),t("div",gt,[a(j,{modelValue:V(Q).isOpeneds,"onUpdate:modelValue":v[8]||(v[8]=e=>V(Q).isOpeneds=e),label:"默认展开"},null,8,["modelValue"])])):n("",!0),u("div",yt,[a($,{onClick:ae},{default:c((()=>[g("确定")])),_:1})])])):(l(),t("div",dt,"点击左侧导航项进行编辑"))]),u("div",null,[a($,{onClick:ee},{default:c((()=>[a(x,null,{default:c((()=>[a(F)])),_:1}),g("添加菜单项 ")])),_:1})])])),[[B,V(U)]])])),_:1},8,["modelValue"]),a(il,{modelValue:V(G),"onUpdate:modelValue":v[12]||(v[12]=e=>T(G)?G.value=e:G=e),useIcon:V(q),onConfirmIcon:H},null,8,["modelValue","useIcon"])],64)}}},[["__scopeId","data-v-75933c8d"]]),Ct={class:"nav-list"},xt=["onClick"],wt={key:0,class:"action-icon"},It=["onClick"],Vt=["onClick"],Tt={key:0,class:"add-box"},Lt=E({__name:"navigationList",setup(m){const{TOGGLE_menuIsCollapse:p}=$l(),f=B(),{navigationList:h,chosenNavigationId:v}=D(F()),{setNavigationList:y}=F(),{menuIsCollapse:b}=D($l()),k=L("$API"),C=L("$TOOL");let w=x(!1),I=x({});const O=e=>{w.value=!0,I.value=Object.assign({},e)};return(m,x)=>{const L=e("ElIconEditPen"),M=e("el-icon"),N=e("ElIconCloseBold"),E=e("ElIconPlus"),j=e("el-button"),$=e("el-icon-expand"),F=e("el-icon-fold"),S=e("el-popover");return l(),t(i,null,[a(S,{placement:"top",width:200,trigger:"hover","popper-style":{padding:0}},{reference:c((()=>[u("div",{class:"adminui-side-bottom",onClick:x[1]||(x[1]=(...e)=>V(p)&&V(p)(...e))},[V(b)?(l(),s(M,{key:0},{default:c((()=>[a($)])),_:1})):(l(),s(M,{key:1},{default:c((()=>[a(F)])),_:1}))])])),default:c((()=>[u("div",Ct,[(l(!0),t(i,null,o(V(h),((e,i)=>(l(),t("div",{class:_(["nav-item text-ellipsis",{"is-active":V(v)==e.layoutConfigId}]),key:i,onClick:l=>(async e=>{f.push("/web/dashboard"),await k.layoutConfig.saveUserLayoutCache("NAV",e.layoutConfigId)&&location.reload()})(e)},[g(d(e.configName)+" ",1),V(C).checkRole("r6007")?(l(),t("div",wt,[u("span",{class:"icon-span edit-icon mr-5",onClick:r((l=>O(e)),["stop"])},[a(M,null,{default:c((()=>[a(L)])),_:1})],8,It),u("span",{class:"icon-span",onClick:r((l=>((e,l)=>{Y.confirm("是否确认删除?","提示：",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((async()=>{if(await k.layoutConfig.deleteConfig(e.layoutConfigId)){v.value==e.layoutConfigId&&f.go(0);let t=[...h.value];t.splice(l,1),y(t)}})).catch((()=>{}))})(e,i)),["stop"])},[a(M,{size:"16"},{default:c((()=>[a(N)])),_:1})],8,Vt)])):n("",!0)],10,xt)))),128)),V(C).checkRole("r6007")?(l(),t("div",Tt,[a(j,{class:"add-btn mt-5 w-100",size:"small",onClick:x[0]||(x[0]=e=>O({}))},{default:c((()=>[a(M,{class:"top-1 mr-3"},{default:c((()=>[a(E)])),_:1}),g("添加导航 ")])),_:1})])):n("",!0)])])),_:1}),V(w)?(l(),s(_t,{key:0,modelValue:V(w),"onUpdate:modelValue":x[2]||(x[2]=e=>T(w)?w.value=e:w=e),menuInfo:V(I)},null,8,["modelValue","menuInfo"])):n("",!0)],64)}}},[["__scopeId","data-v-3a1d212e"]]),{publicSetting:Ot}=D(j()),{keepLiveRoute:Mt,routeShow:Nt}=D(G()),{ismobile:Et,layout:jt,layoutTags:$t,menuIsCollapse:Ft}=D($l()),{SET_ismobile:St,TOGGLE_menuIsCollapse:Ut}=$l(),Pt={class:"adminui-header"},At={class:"adminui-header-left"},Dt={class:"logo-bar"},zt={key:0,class:"nav"},Rt=["onClick"],Gt={class:"adminui-header-right"},qt={class:"aminui-wrapper"},Bt={key:0,class:"adminui-side-top"},Ht={class:"adminui-side-scroll"},Jt={class:"aminui-body el-container"},Wt={class:"adminui-main",id:"adminui-main"},Yt={key:0,class:"not-plugin"},Kt={class:"adminui-header"},Xt={class:"adminui-header-left"},Qt={class:"logo-bar"},Zt={class:"adminui-header-right"},ea={class:"aminui-wrapper"},la={class:"adminui-side-scroll"},ta={class:"aminui-body el-container"},aa={class:"adminui-main",id:"adminui-main"},na={key:0,class:"not-plugin"},ia={class:"adminui-header"},oa={class:"adminui-header-left"},sa={class:"logo-bar"},ca={class:"adminui-header-right"},ua={key:0,class:"adminui-header-menu"},da={class:"aminui-wrapper"},ra={class:"aminui-body el-container"},ma={class:"adminui-main",id:"adminui-main"},pa={key:0,class:"not-plugin"},fa={key:3,class:"aminui-wrapper"},ha={key:0,class:"aminui-side-split"},va={class:"aminui-side-split-top"},ga=["title"],ya={class:"adminui-side-split-scroll"},ba=["onClick"],ka={key:0,class:"adminui-side-top"},_a={class:"adminui-side-scroll"},Ca={class:"aminui-body el-container"},xa={class:"adminui-main",id:"adminui-main"},wa={key:0,class:"not-plugin"};const Ia=E({name:"index",components:{SideM:ie,Topbar:re,Tags:Oe,NavMenu:te,userbar:jl,setting:Al,iframeView:Yl,autoExit:Kl,navigation:Lt},data:()=>({settingDialog:!1,menu:[],nextMenu:[],pmenu:{},active:"",defaultOpeneds:[],pluginInfo:{TriggerList:{pluginName:"metaTrigger",errMsg:"触发器 插件未安装！"},TriggerLog:{pluginName:"metaTrigger",errMsg:"触发器 插件未安装！"},DashboardDesign:{pluginName:"metaDataCube",errMsg:"数据分析 插件未安装！"},TemplatesList:{pluginName:"mannerReport",errMsg:"在线报表 插件未安装！"}},needPlugin:["TriggerList","DashboardDesign","TemplatesList","TriggerLog"]}),computed:{routeShowFn:()=>Nt.value,keepLiveRouteFn:()=>Mt.value,ismobileFn:()=>Et.value,layoutFn:()=>jt.value,layoutTagsFn:()=>$t.value,menuIsCollapseFn:()=>Ft.value,appName:()=>Ot.value.APP_NAME},created(){this.onLayoutResize(),window.addEventListener("resize",this.onLayoutResize);var e=this.$router.sc_getMenu();this.menu=this.filterUrl(e),this.getDefaultOpeneds(),this.showThis()},watch:{$route(){this.showThis()},layout:{handler(e){document.body.setAttribute("data-layout",e)},immediate:!0}},methods:{checkPlugin(e){let l=Ot.value.APP_PLUGINID||[],t=e.name;if(!this.needPlugin.includes(t))return!1;let a=this.pluginInfo[t];return!l.includes(a.pluginName)},getDefaultOpeneds(){this.menu[0].children.forEach((e=>{e.meta.isOpeneds&&this.defaultOpeneds.push(e.path)}))},openSetting(){this.settingDialog=!0},onLayoutResize(){St(document.body.clientWidth<992)},showThis(){this.pmenu=this.$route.meta.breadcrumb?this.$route.meta.breadcrumb[0]:{},this.nextMenu=this.filterUrl(this.pmenu.children),this.$nextTick((()=>{this.active=this.$route.meta.active||this.$route.fullPath}))},showMenu(e){2!=e.type?(this.pmenu=e,this.nextMenu=this.filterUrl(e.children),e.children&&0!=e.children.length||!e.component||this.$router.push({path:e.path})):window.open(e.outLink)},filterUrl(e){var l=[];return e&&e.forEach((e=>{if(e.meta=e.meta?e.meta:{},e.meta.hidden||"button"==e.meta.type)return!1;"iframe"==e.meta.type&&(e.path=`/i/${e.name}`),e.children&&e.children.length>0&&(e.children=this.filterUrl(e.children)),l.push(e)})),l},exitMaximize(){document.getElementById("app").classList.remove("main-maximize")}}},[["render",function(r,f,h,v,g,y){const b=e("mlLogo"),k=e("el-icon"),C=e("userbar"),x=e("NavMenu"),w=e("el-menu"),I=e("el-scrollbar"),V=e("navigation"),T=e("Side-m"),L=e("Topbar"),O=e("Tags"),M=e("router-view"),E=e("iframe-view"),j=e("mlWaterMark"),$=e("router-link"),F=e("el-icon-close"),S=e("auto-exit");return l(),t(i,null,["header"==y.layoutFn?(l(),t(i,{key:0},[u("header",Pt,[u("div",At,[u("div",Dt,[a(b,{class:"logo"}),u("span",null,d(y.appName),1)]),y.ismobileFn?n("",!0):(l(),t("ul",zt,[(l(!0),t(i,null,o(g.menu,(e=>(l(),t("li",{key:e,class:_(g.pmenu.path==e.path?"active":""),onClick:l=>y.showMenu(e)},[a(k,{style:m({color:e.meta.iconColor})},{default:c((()=>[(l(),s(p(e.meta.icon||"el-icon-menu")))])),_:2},1032,["style"]),u("span",null,d(e.meta.title),1)],10,Rt)))),128))]))]),u("div",Gt,[a(C)])]),u("section",qt,[a(j,null,{default:c((()=>[!y.ismobileFn&&g.nextMenu.length>0||!g.pmenu.component?(l(),t("div",{key:0,class:_(y.menuIsCollapseFn?"aminui-side isCollapse":"aminui-side")},[y.menuIsCollapseFn?n("",!0):(l(),t("div",Bt,[u("h2",null,d(g.pmenu.meta.title),1)])),u("div",Ht,[a(I,null,{default:c((()=>[a(w,{"default-openeds":g.defaultOpeneds,"default-active":g.active,router:"",collapse:y.menuIsCollapseFn,"unique-opened":r.$CONFIG.MENU_UNIQUE_OPENED},{default:c((()=>[a(x,{navMenus:g.nextMenu},null,8,["navMenus"])])),_:1},8,["default-openeds","default-active","collapse","unique-opened"])])),_:1})]),a(V)],2)):n("",!0),y.ismobileFn?(l(),s(T,{key:1})):n("",!0),u("div",Jt,[y.ismobileFn?n("",!0):(l(),s(L,{key:0})),!y.ismobileFn&&y.layoutTagsFn?(l(),s(O,{key:1})):n("",!0),u("div",Wt,[y.checkPlugin(r.$route)?(l(),t("div",Yt,d(g.pluginInfo[r.$route.name].errMsg),1)):(l(),t(i,{key:1},[a(M,null,{default:c((({Component:e})=>[(l(),s(N,{include:y.keepLiveRouteFn},[y.routeShowFn?(l(),s(p(e),{key:r.$route.fullPath})):n("",!0)],1032,["include"]))])),_:1}),a(E)],64))])])])),_:1})])],64)):"menu"==y.layoutFn?(l(),t(i,{key:1},[u("header",Kt,[u("div",Xt,[u("div",Qt,[a(b,{class:"logo"}),u("span",null,d(y.appName),1)])]),u("div",Zt,[a(C)])]),u("section",ea,[a(j,null,{default:c((()=>[y.ismobileFn?n("",!0):(l(),t("div",{key:0,class:_(y.menuIsCollapseFn?"aminui-side isCollapse":"aminui-side")},[u("div",la,[a(I,null,{default:c((()=>[a(w,{"default-openeds":g.defaultOpeneds,"default-active":g.active,router:"",collapse:y.menuIsCollapseFn,"unique-opened":r.$CONFIG.MENU_UNIQUE_OPENED},{default:c((()=>[a(x,{navMenus:g.menu},null,8,["navMenus"])])),_:1},8,["default-openeds","default-active","collapse","unique-opened"])])),_:1})]),a(V)],2)),y.ismobileFn?(l(),s(T,{key:1})):n("",!0),u("div",ta,[y.ismobileFn?n("",!0):(l(),s(L,{key:0})),!y.ismobileFn&&y.layoutTagsFn?(l(),s(O,{key:1})):n("",!0),u("div",aa,[y.checkPlugin(r.$route)?(l(),t("div",na,d(g.pluginInfo[r.$route.name].errMsg),1)):(l(),t(i,{key:1},[a(M,null,{default:c((({Component:e})=>[(l(),s(N,{include:y.keepLiveRouteFn},[y.routeShowFn?(l(),s(p(e),{key:r.$route.fullPath})):n("",!0)],1032,["include"]))])),_:1}),a(E)],64))])])])),_:1})])],64)):"dock"==y.layoutFn?(l(),t(i,{key:2},[u("header",ia,[u("div",oa,[u("div",sa,[a(b,{class:"logo"}),u("span",null,d(y.appName),1)])]),u("div",ca,[y.ismobileFn?n("",!0):(l(),t("div",ua,[a(w,{"default-openeds":g.defaultOpeneds,mode:"horizontal","default-active":g.active,router:"","background-color":"#222b45","text-color":"#fff","active-text-color":"var(--el-color-primary)"},{default:c((()=>[a(x,{navMenus:g.menu},null,8,["navMenus"])])),_:1},8,["default-openeds","default-active"])])),y.ismobileFn?(l(),s(T,{key:1})):n("",!0),a(C)])]),u("section",da,[a(j,null,{default:c((()=>[u("div",ra,[!y.ismobileFn&&y.layoutTagsFn?(l(),s(O,{key:0})):n("",!0),u("div",ma,[y.checkPlugin(r.$route)?(l(),t("div",pa,d(g.pluginInfo[r.$route.name].errMsg),1)):(l(),t(i,{key:1},[a(M,null,{default:c((({Component:e})=>[(l(),s(N,{include:y.keepLiveRouteFn},[y.routeShowFn?(l(),s(p(e),{key:r.$route.fullPath})):n("",!0)],1032,["include"]))])),_:1}),a(E)],64))])])])),_:1})])],64)):(l(),t("section",fa,[a(j,null,{default:c((()=>[y.ismobileFn?n("",!0):(l(),t("div",ha,[u("div",va,[a($,{to:r.$CONFIG.DASHBOARD_URL},{default:c((()=>[u("img",{class:"logo",title:y.appName,src:"/assets/logo-r-5583fceb.png"},null,8,ga)])),_:1},8,["to"])]),u("div",ya,[a(I,null,{default:c((()=>[u("ul",null,[(l(!0),t(i,null,o(g.menu,(e=>(l(),t("li",{key:e,class:_(g.pmenu.path==e.path?"active":""),onClick:l=>y.showMenu(e)},[a(k,null,{default:c((()=>[(l(),s(p(e.meta.icon||r.el-r.icon-g.menu)))])),_:2},1024),u("p",null,d(e.meta.title),1)],10,ba)))),128))])])),_:1})])])),!y.ismobileFn&&g.nextMenu.length>0||!g.pmenu.component?(l(),t("div",{key:1,class:_(y.menuIsCollapseFn?"aminui-side isCollapse":"aminui-side")},[y.menuIsCollapseFn?n("",!0):(l(),t("div",ka,[u("h2",null,d(g.pmenu.meta.title),1)])),u("div",_a,[a(I,null,{default:c((()=>[a(w,{"default-openeds":g.defaultOpeneds,"default-active":g.active,router:"",collapse:y.menuIsCollapseFn,"unique-opened":r.$CONFIG.MENU_UNIQUE_OPENED},{default:c((()=>[a(x,{navMenus:g.nextMenu},null,8,["navMenus"])])),_:1},8,["default-openeds","default-active","collapse","unique-opened"])])),_:1})]),a(V)],2)):n("",!0),y.ismobileFn?(l(),s(T,{key:2})):n("",!0),u("div",Ca,[a(L,null,{default:c((()=>[a(C)])),_:1}),!y.ismobileFn&&y.layoutTagsFn?(l(),s(O,{key:0})):n("",!0),u("div",xa,[y.checkPlugin(r.$route)?(l(),t("div",wa,d(g.pluginInfo[r.$route.name].errMsg),1)):(l(),t(i,{key:1},[a(M,null,{default:c((({Component:e})=>[(l(),s(N,{include:y.keepLiveRouteFn},[y.routeShowFn?(l(),s(p(e),{key:r.$route.fullPath})):n("",!0)],1032,["include"]))])),_:1}),a(E)],64))])])])),_:1})])),u("div",{class:"main-maximize-exit",onClick:f[0]||(f[0]=(...e)=>y.exitMaximize&&y.exitMaximize(...e))},[a(k,null,{default:c((()=>[a(F)])),_:1})]),a(S)],64)}]]);export{Ia as default};
