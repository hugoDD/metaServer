import{u as e}from"./vue-router-414ebc36.js";import{R as t,r as a,l,o as i,a as o,c as n,w as r,E as s,F as d,g as u}from"./@vue-1ad4818c.js";const c=u("span",{class:"ml-5"},"添加",-1),g={__name:"trigger-list",setup(u){const g=t("$TOOL"),p=e();let m=a(""),f=a([{fieldName:"name",op:"LK",value:""}]),y=a([{prop:"name",label:"名称",sortable:!0,highlight:!0},{prop:"entityCode",label:"源实体",entityCode:!0,sortable:!0},{prop:"actionType",label:"触发类型",align:"center",needField:"label"},{prop:"whenNum",label:"触发动作",align:"center",customSolt:"whenNum"},{prop:"priority",label:"优先级",align:"center",customSolt:"priority"},{prop:"isDisabled",label:"启用",align:"center",customSolt:"switch",isNegation:!0,width:80},{prop:"modifiedOn",label:"修改时间",align:"center",width:100,fromNow:!0}]),v=a(),b=a({saveEntity:"TriggerConfig",saveIdCode:"triggerConfigId",checkCodes:["actionType","name"],codeErrMsg:["请选择触发器","请输入名称"],fromEntityLabel:"源实体",showFormItem:[{label:"名称",code:"name",type:"1"}]});const C=()=>{h({target:"add"})},h=e=>{let{target:t,row:a}=e,{defaultCode:l}=m.value;if("add"===t)b.value.title="添加触发器",b.value.form={entityCode:"all"==l?"":parseInt(l)},b.value.type="add";else{b.value.title="编辑触发器",b.value.type="edit";let e={...a};e.actionType=e.actionType.value,b.value.form={...e}}v.value.openDialog(b.value)},w=e=>{let t={...e};t.actionType=t.actionType.value,b.value.form={...t},v.value.dialogForm={...b.value},v.value.saveProcess()},I=async()=>{m.value.getEntityList()},T=e=>{p.push({path:"/web/trigger-detail",query:{triggerConfigId:e.triggerConfigId}})};return(e,t)=>{const a=l("ElIconPlus"),u=l("el-icon"),p=l("el-button"),b=l("mlEntityMenuAndList"),E=l("mlActiveDialog");return i(),o(d,null,[n(b,{ref_key:"mlEntityMenuAndListRef",ref:m,entityName:"TriggerConfig",aciveId:"triggerConfigId",fieldsList:"name,entityCode,actionType,actionContent,priority,isDisabled,modifiedOn,whenNum,createdOn",onGoDetial:T,tableColumn:s(y),defalutSortField:"createdOn",filterItems:s(f),onActionBtn:h,onChangeSwitch:w,onOpenAddDialog:C,checkRole:"r48"},{addbutton:r((()=>[n(p,{type:"primary",onClick:t[0]||(t[0]=e=>h({target:"add"})),disabled:!s(g).checkRole("r48-2")},{default:r((()=>[n(u,{size:"14"},{default:r((()=>[n(a)])),_:1}),c])),_:1},8,["disabled"])])),_:1},8,["tableColumn","filterItems"]),n(E,{ref_key:"mlActiveDialogRefs",ref:v,onSaveProcess:I},null,512)],64)}}};export{g as default};
