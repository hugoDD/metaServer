import{s}from"./index-5f56df68.js";import{_ as e,f as r,j as o,aF as t}from"./index-ea085229.js";import{s as a}from"./pinia-3f60a8e1.js";import{l as i,o as m,i as l,w as p,c as d,z as n,g as u}from"./@vue-1ad4818c.js";import"./element-plus-bab58d46.js";import"./lodash-es-b8e8104a.js";import"./@vueuse-477b4dbb.js";import"./@element-plus-2a6d398c.js";import"./@babel-6bd44fd1.js";import"./@popperjs-b78c3215.js";import"./@ctrl-4982d949.js";import"./dayjs-7fb79ad3.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./escape-html-3148dbc9.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-0ef99041.js";import"./vue3-manner-report-313033e6.js";import"./axios-85bcd05e.js";import"./crypto-js-43a3a23e.js";import"./cron-parser-1391a961.js";import"./luxon-b01799b6.js";import"./vue-router-414ebc36.js";import"./nprogress-c04e6182.js";import"./sortablejs-2f5483e3.js";import"./qrcodejs2-fix-bab07f30.js";import"./moment-bafe441d.js";import"./pinyin-pro-c81f5d39.js";import"./vue-i18n-0843b5c5.js";import"./@intlify-2528d766.js";import"./source-map-b06bd4b9.js";import"./vue-c723f8b1.js";import"./pinia-plugin-persistedstate-d2bd58cf.js";import"./resize-observer-polyfill-ad543aa3.js";import"./vue-smart-widget-8b3f5b0a.js";import"./echarts-b5d24e9a.js";import"./zrender-a15b073b.js";import"./tslib-a4e99503.js";import"./echarts-liquidfill-f5c863f1.js";import"./@antv-43d380be.js";import"./ant-design-vue-2db0c9af.js";import"./@ant-design-60f2ef8e.js";import"./vue-types-6bcea8eb.js";import"./dom-align-78cb5391.js";import"./vue-draggable-next-a413f884.js";import"./vue-resize-observer-90aea344.js";const{publicSetting:w}=a(r()),j={components:{scPasswordStrength:s},data(){return{form:{userPassword:"",newPassword:"",confirmNewPassword:""},rules:{userPassword:[{required:!0,message:"请输入当前密码"}],newPassword:[{required:!0,message:"请输入新密码"}],confirmNewPassword:[{required:!0,message:"请再次输入新密码"},{validator:this.validatePass2}]}}},methods:{validatePass2(s,e,r){e!==this.form.newPassword?r(new Error("两次输入密码不一致")):r()},save(){w.value.trialVersionFlag?this.$message.error("试用版本已禁用修改密码功能，敬请谅解"):this.$refs.form.validate((async s=>{if(!s)return!1;if(!/(?=.*([a-zA-Z].*))(?=.*[0-9].*)[a-zA-Z0-9-*/+.~!@#$%^&*()]{6,20}$/.test(this.form.newPassword))return void this.$message.error("必须包含数字、英文。密码长度为：6-20位");await o.get("/user/updatePassword",{userName:t.data.get("USER_INFO").loginName,password:this.form.userPassword,newPassword:this.form.newPassword})&&this.$alert("密码修改成功，是否跳转至登录页使用新密码登录","修改成功",{type:"success",center:!0}).then((()=>{this.$router.replace({path:"/web/login"})})).catch((()=>{}))}))}}},f=u("div",{class:"el-form-item-msg"},"必须提供当前登录用户密码才能进行更改",-1),c=u("div",{class:"el-form-item-msg"},"请输入包含英文、数字的6-20位密码",-1);const h=e(j,[["render",function(s,e,r,o,t,a){const u=i("el-alert"),w=i("el-input"),j=i("el-form-item"),h=i("sc-password-strength"),g=i("el-button"),v=i("el-form"),P=i("el-card");return m(),l(P,{shadow:"never",header:"修改密码"},{default:p((()=>[d(u,{title:"密码更新成功后，您将被重定向到登录页面，您可以使用新密码重新登录。",type:"info","show-icon":"",style:{"margin-bottom":"15px"}}),d(v,{ref:"form",model:t.form,rules:t.rules,"label-width":"120px",style:{"margin-top":"20px"}},{default:p((()=>[d(j,{label:"当前密码",prop:"userPassword"},{default:p((()=>[d(w,{modelValue:t.form.userPassword,"onUpdate:modelValue":e[0]||(e[0]=s=>t.form.userPassword=s),type:"password","show-password":"",placeholder:"请输入当前密码"},null,8,["modelValue"]),f])),_:1}),d(j,{label:"新密码",prop:"newPassword"},{default:p((()=>[d(w,{modelValue:t.form.newPassword,"onUpdate:modelValue":e[1]||(e[1]=s=>t.form.newPassword=s),type:"password","show-password":"",placeholder:"请输入新密码"},null,8,["modelValue"]),d(h,{modelValue:t.form.newPassword,"onUpdate:modelValue":e[2]||(e[2]=s=>t.form.newPassword=s)},null,8,["modelValue"]),c])),_:1}),d(j,{label:"确认新密码",prop:"confirmNewPassword"},{default:p((()=>[d(w,{modelValue:t.form.confirmNewPassword,"onUpdate:modelValue":e[3]||(e[3]=s=>t.form.confirmNewPassword=s),type:"password","show-password":"",placeholder:"请再次输入新密码"},null,8,["modelValue"])])),_:1}),d(j,null,{default:p((()=>[d(g,{type:"primary",onClick:a.save},{default:p((()=>[n("保存密码")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model","rules"])])),_:1})}]]);export{h as default};
