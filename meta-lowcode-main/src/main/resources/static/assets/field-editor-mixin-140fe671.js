import{F as e}from"./field-state-variables-3bb6d4cb.js";import{aq as i,ar as s,ad as t,ae as a,a0 as r}from"./index-ea085229.js";const d={data:()=>({rules:{name:[{required:!0,message:"请输入字段名称",trigger:"blur"},{pattern:/^[a-z]+[A-Za-z\d]*$/,message:"请以小写英文字母开头，中间可输入字母或数字，禁止中文",trigger:"blur"},{min:2,max:30,message:"文字长度应在2-30之间",trigger:"blur"}],label:[{required:!0,message:"请输入显示名称",trigger:"blur"},{pattern:/^[A-Za-z\d\u4e00-\u9fa5]+[_-]*/,message:"请以中文、英文字母、数字开头，中间可输入下划线或横杠",trigger:"blur"},{min:2,max:30,message:"文字长度应在2-30之间",trigger:"blur"}]}}),mounted(){this.fieldState===e.EDIT&&this.loadFieldProps()},methods:{async createNewField(){let e=await i(this.fieldProps,this.entity);e&&200==e.code&&(this.$message.success("保存成功"),this.$emit("fieldSaved"))},async modifyOldField(){let e=await s(this.fieldProps,this.entity);e&&200==e.code&&(this.$message.success("保存成功"),this.$emit("fieldSaved"))},doSave(i){this.$refs.editorForm.validate((s=>{if(!s)return this.$message.error("数据不合规范，请检查"),!1;this.fieldProps.type=i,this.fieldState===e.NEW?this.createNewField():this.fieldState===e.EDIT&&this.modifyOldField()}))},cancelSave(){this.$emit("cancelSave")},async loadFieldProps(){if(this.fieldState!==e.EDIT)return;let i=await t(this.fieldName,this.entity);i&&200==i.code&&(a(this.fieldProps,i.data),this.fieldProps.fieldViewModel||(this.fieldProps.fieldViewModel={}),this.fieldProps.referenceSetting||(this.fieldProps.referenceSetting=[]))},handleFieldLabelChange(e){e&&(this.fieldProps.name||(this.fieldProps.name=r(e)))},generateFieldName(){this.fieldProps.name=r(this.fieldProps.label)}}};export{d as f};
