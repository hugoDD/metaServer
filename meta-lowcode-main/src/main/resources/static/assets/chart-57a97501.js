import{R as e,r as t,v as a,l,o as r,a as i,c as o,w as s,g as n,E as m,a0 as d,z as p,F as u}from"./@vue-1ad4818c.js";import{$ as c,d as h,s as f,P as j}from"./index-ea085229.js";import{u as v}from"./vue-router-414ebc36.js";import g from"./Allocation-359987ff.js";import{b as w}from"./element-plus-bab58d46.js";import"./vue3-manner-report-313033e6.js";import"./axios-85bcd05e.js";import"./crypto-js-43a3a23e.js";import"./@babel-6bd44fd1.js";import"./cron-parser-1391a961.js";import"./luxon-b01799b6.js";import"./nprogress-c04e6182.js";import"./pinia-3f60a8e1.js";import"./sortablejs-2f5483e3.js";import"./qrcodejs2-fix-bab07f30.js";import"./@element-plus-2a6d398c.js";import"./moment-bafe441d.js";import"./pinyin-pro-c81f5d39.js";import"./vue-i18n-0843b5c5.js";import"./@intlify-2528d766.js";import"./source-map-b06bd4b9.js";import"./vue-c723f8b1.js";import"./@vueuse-477b4dbb.js";import"./pinia-plugin-persistedstate-d2bd58cf.js";import"./resize-observer-polyfill-ad543aa3.js";import"./vue-smart-widget-8b3f5b0a.js";import"./echarts-b5d24e9a.js";import"./zrender-a15b073b.js";import"./tslib-a4e99503.js";import"./echarts-liquidfill-f5c863f1.js";import"./@antv-43d380be.js";import"./ant-design-vue-2db0c9af.js";import"./lodash-es-b8e8104a.js";import"./@ant-design-60f2ef8e.js";import"./@ctrl-4982d949.js";import"./dayjs-7fb79ad3.js";import"./vue-types-6bcea8eb.js";import"./dom-align-78cb5391.js";import"./vue-draggable-next-a413f884.js";import"./vue-resize-observer-90aea344.js";import"./@popperjs-b78c3215.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./escape-html-3148dbc9.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-0ef99041.js";const y=n("span",{class:"ml-5"},"添加",-1),b={class:"mr-3"},C=n("span",null,"分配",-1),_={class:"mr-3"},I=n("span",null,"编辑",-1),k={class:"mr-3"},N=n("span",null,"删除",-1),S={style:{"padding-right":"60px"}},x={__name:"chart",setup(x){const z=v(),E=e("$ElMessage");let V=t([{fieldName:"createdOn",type:"DESC"}]),L=t([]),D=t([{prop:"chartName",label:"名称",highlight:!0},{prop:"modifiedOn",label:"修改时间",formatter:e=>c(e.modifiedOn)},{prop:"modifiedBy.name",label:"修改用户",formatter:e=>{var t;return null==(t=e.modifiedBy)?void 0:t.name}},{prop:"ownerUser.name",label:"所属用户",formatter:e=>{var t;return null==(t=e.ownerUser)?void 0:t.name}},{prop:"ownerDepartment.name",label:"所属部门",formatter:e=>{var t;return null==(t=e.ownerDepartment)?void 0:t.name}}]),T=a({isShow:!1,chartName:"",chartId:"",title:""});const U=()=>{T.isShow=!0,T.chartName="",T.chartId="",T.title="新建仪表盘"};let B=t();const M=async()=>{B.value.loading=!0;let e={entity:"Chart",formModel:{chartName:T.chartName},id:T.chartId};T.chartId||(e.formModel.defaultChart=!1),await f(e.entity,e.id,e.formModel)&&(T.isShow=!1,B.value.getTableList()),B.value.loading=!1},q=e=>{let t={path:"/web/dashboard-design",query:{chartId:e.chartId}};z.push(t)};let F=t("");const O=()=>{B.value.getTableList()};return(e,t)=>{const a=l("ElIconPlus"),c=l("el-icon"),f=l("el-button"),v=l("el-switch"),x=l("el-table-column"),z=l("ElIconShare"),R=l("ElIconEdit"),A=l("ElIconDelete"),H=l("mlSingleList"),P=l("el-input"),$=l("el-form-item"),G=l("el-form"),J=l("ml-dialog");return r(),i(u,null,[o(H,{ref_key:"mlSingleListRef",ref:B,title:"仪表盘",mainEntity:"Chart",fieldsList:"chartName,ownerUser,ownerDepartment,modifiedOn,modifiedBy,defaultChart",sortFields:m(V),fieldName:"chartName",tableColumn:m(D),filterItems:m(L),onHighlightClick:q},{addbutton:s((()=>[o(f,{type:"primary",onClick:U},{default:s((()=>[o(c,{size:"14"},{default:s((()=>[o(a)])),_:1}),y])),_:1})])),activeRow:s((()=>[o(x,{label:"默认视图",align:"center",width:"100"},{default:s((e=>[o(v,{modelValue:e.row.defaultChart,"onUpdate:modelValue":t=>e.row.defaultChart=t,onChange:t=>(async e=>{B.value.loading=!0,await j(e.chartId,e.defaultChart)&&(T.isShow=!1,B.value.getTableList()),B.value.loading=!1})(e.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])])),_:1}),o(x,{label:"操作",align:"center",width:"200",fixed:"right"},{default:s((e=>[o(f,{size:"small",type:"primary",link:"",onClick:t=>{return a=e.row,void F.value.openDialog({type:"allocation",pageType:"dashboardList",list:[a]});var a}},{default:s((()=>[n("span",b,[o(c,null,{default:s((()=>[o(z)])),_:1})]),C])),_:2},1032,["onClick"]),o(f,{size:"small",type:"primary",link:"",onClick:t=>{return a=e.row,T.isShow=!0,T.chartName=a.chartName,T.chartId=a.chartId,void(T.title="编辑仪表盘");var a}},{default:s((()=>[n("span",_,[o(c,null,{default:s((()=>[o(R)])),_:1})]),I])),_:2},1032,["onClick"]),o(f,{size:"small",link:"",type:"primary",onClick:t=>{return a=e.row,void w.confirm("是否确认删除?","提示：",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((async()=>{let e=await h(a.chartId);B.value.loading=!0,e&&(E.success("删除成功"),B.value.getTableList()),B.value.loading=!1})).catch((()=>{}));var a}},{default:s((()=>[n("span",k,[o(c,null,{default:s((()=>[o(A)])),_:1})]),N])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["sortFields","tableColumn","filterItems"]),o(J,{title:m(T).title,modelValue:m(T).isShow,"onUpdate:modelValue":t[3]||(t[3]=e=>m(T).isShow=e),width:"600"},{default:s((()=>[n("div",S,[o(G,{"label-width":"80px",onSubmit:t[2]||(t[2]=d((()=>{}),["prevent"]))},{default:s((()=>[o($,{label:"名称"},{default:s((()=>[o(P,{modelValue:m(T).chartName,"onUpdate:modelValue":t[0]||(t[0]=e=>m(T).chartName=e)},null,8,["modelValue"])])),_:1}),o($,null,{default:s((()=>[o(f,{type:"primary",onClick:M},{default:s((()=>[p("确定")])),_:1}),o(f,{onClick:t[1]||(t[1]=e=>m(T).isShow=!1)},{default:s((()=>[p("取消")])),_:1})])),_:1})])),_:1})])])),_:1},8,["title","modelValue"]),o(g,{ref_key:"allocationRefs",ref:F,idFieldName:"chartId",onAllocationSuccess:O},null,512)],64)}}};export{x as default};
