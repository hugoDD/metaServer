import{_ as e,f as a,g as t,q as s}from"./index-ea085229.js";import{s as r}from"./pinia-3f60a8e1.js";import{u as i}from"./vue-router-414ebc36.js";import{R as l,r as o,p as u,n as p,l as m,Y as n,E as d,X as v,o as c,a as j,F as h,i as f,f as g,w as y,g as b,c as I,A as k,e as _,t as C}from"./@vue-1ad4818c.js";import"./element-plus-bab58d46.js";import"./lodash-es-b8e8104a.js";import"./@vueuse-477b4dbb.js";import"./@element-plus-2a6d398c.js";import"./@babel-6bd44fd1.js";import"./@popperjs-b78c3215.js";import"./@ctrl-4982d949.js";import"./dayjs-7fb79ad3.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./escape-html-3148dbc9.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-0ef99041.js";import"./vue3-manner-report-313033e6.js";import"./axios-85bcd05e.js";import"./crypto-js-43a3a23e.js";import"./cron-parser-1391a961.js";import"./luxon-b01799b6.js";import"./nprogress-c04e6182.js";import"./sortablejs-2f5483e3.js";import"./qrcodejs2-fix-bab07f30.js";import"./moment-bafe441d.js";import"./pinyin-pro-c81f5d39.js";import"./vue-i18n-0843b5c5.js";import"./@intlify-2528d766.js";import"./source-map-b06bd4b9.js";import"./vue-c723f8b1.js";import"./pinia-plugin-persistedstate-d2bd58cf.js";import"./resize-observer-polyfill-ad543aa3.js";import"./vue-smart-widget-8b3f5b0a.js";import"./echarts-b5d24e9a.js";import"./zrender-a15b073b.js";import"./tslib-a4e99503.js";import"./echarts-liquidfill-f5c863f1.js";import"./@antv-43d380be.js";import"./ant-design-vue-2db0c9af.js";import"./@ant-design-60f2ef8e.js";import"./vue-types-6bcea8eb.js";import"./dom-align-78cb5391.js";import"./vue-draggable-next-a413f884.js";import"./vue-resize-observer-90aea344.js";const N={key:0,class:"dashboard"},D={class:"dashboard-list"},w=["title","onClick"],x={class:"change-dashboard"},z={key:1,class:"not-plugin"},q=e({__name:"index",setup(e){const q=i(),{publicSetting:A}=r(a()),L=l("$TOOL");let E=o(""),J=o(!1),O=o([]),P=o(""),S=o(""),F=o(""),G=o(!1),R=o([]),T=o(!1),B=o("");u((()=>{R.value=A.value.APP_PLUGINID||[],T.value=R.value.includes("metaDataCube"),B.value=q.currentRoute.value.query.default,T.value&&H()}));const H=async()=>{J.value=!0,S.value=L.data.get("defaultChartId")||!1;let e=await t("Chart","chartName,defaultChart",{equation:"AND",items:[{fieldName:"chartData",op:"NT",value:""}]});if(e&&e.data){if(O.value=e.data.dataList||[],O.value.length<1)return void(J.value=!1);if(B.value){let e=O.value.filter((e=>e.chartId==B.value));e.length>0?(P.value=e[0].chartId,K(P.value),J.value=!1):(O.value=[],J.value=!1)}let a=O.value.filter((e=>e.defaultChart));if(a.length>0)return P.value=a[0].chartId,K(P.value),void(J.value=!1);K(O.value[0].chartId),J.value=!1}else J.value=!1},K=async e=>{J.value=!0,F.value=e,G.value=!1,L.data.set("defaultChartId",e);let a=await s(e,"chartData");if(a&&a.data.chartData){G.value=!0;let e=JSON.parse(a.data.chartData);p((()=>{E.value&&E.value.setFormJson(e)}))}J.value=!1};return(e,a)=>{const t=m("v-form-render"),s=m("el-scrollbar"),r=m("ElIconSetting"),i=m("el-icon"),l=m("el-popover"),o=m("el-empty"),u=n("loading");return d(T)?v((c(),j("div",N,[d(O).length>0?(c(),j(h,{key:0},[d(G)?(c(),f(t,{key:0,ref_key:"dashboardWidget",ref:E},null,512)):g("",!0),d(B)?g("",!0):(c(),f(l,{key:1,placement:"bottom",width:200,trigger:"click"},{reference:y((()=>[b("span",x,[I(i,{size:"20"},{default:y((()=>[I(r)])),_:1})])])),default:y((()=>[b("div",D,[I(s,null,{default:y((()=>[(c(!0),j(h,null,k(d(O),((e,a)=>(c(),j("div",{class:_(["dashboard-item yichu",{"is-active":e.chartId==d(F)}]),key:a,title:e.chartName,onClick:a=>K(e.chartId)},C(e.chartName),11,w)))),128))])),_:1})])])),_:1}))],64)):(c(),f(o,{key:1,description:"暂无视图"}))])),[[u,d(J)]]):(c(),j("div",z,"数据分析 插件未安装！"))}}},[["__scopeId","data-v-72830e36"]]);export{q as default};
